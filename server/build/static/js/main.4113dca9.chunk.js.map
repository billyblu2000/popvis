{"version":3,"sources":["utils.js","SongSelector/index.jsx","PhraseSelector/index.jsx","ModeSelector/index.jsx","YearBrusher/index.jsx","PhraseItem/index.jsx","SongView/index.jsx","KeyModeView/index.jsx","MelodyView/index.jsx","MeterView/index.jsx","ChordDurationView/index.jsx","PitchRangeView/index.jsx","ChordView/index.jsx","ChordViewFull/index.jsx","Logo/index.jsx","Main/index.jsx","TestComp/index.jsx","App.js","index.js"],"names":["address","SongSelector","props","handelClick","event","setState","selected","target","id","split","PubSub","publish","handelMouseEnter","highlightChange","handelMouseLeave","search","displayed","data","filter","item","name","value","artist","state","yearFilter","searchInput","React","createRef","this","current","undefined","className","ref","placeholder","prefix","SearchOutlined","style","color","bordered","allowClear","width","onChange","overflow","maxHeight","map","idx","onClick","onMouseEnter","onMouseLeave","toString","marginTop","marginBottom","Component","PhraseSelector","intro","verse","chorus","outro","other","publishFilter","cursor","ModeSelector","major","minor","margin","YearBrusher","area","x","y","d3","d","y0","y1","curve","brushed","brushended","selection","start","xAxisScale","invert","end","Date","minMonth","maxMonth","pointermoved","xPosition","rule","attr","xText","formatDate","tooltip","text","mouseEnter","selectAll","mouseLeave","parseDate","preprocess","domain","range","yAxisScale","maxCount","months","publish_year","publish_month","Math","min","apply","max","monthsStats","reduce","obj","month","getTime","Object","values","countPublishs","memo","forEach","push","svg","on","preventDefault","append","call","ticks","every","tickSize","g","datum","extent","height","viewBox","preserveAspectRatio","gradientTransform","offset","stopColor","stopOpacity","themeColor","fullScreen","element","document","documentElement","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","window","onresize","webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullscreenElement","noteText","Text","Typography","tonicMap","modeMap","maj","PhraseItem","playing","changeDisplay","collapse","testVocal","test","label","testVocalUI","getProgression","progressionStr","i","chord_progression","length","console","log","substring","play","e","mp3","Audio","songId","addEventListener","pause","parseInt","display","title","mapType","minWidth","maxWidth","placement","mapTypeCap","lineHeight","valueStyle","fontFamily","marginLeft","tonic","mode","marginRight","chord_duration","pitch_range","textAlign","fontSize","transition","paddingLeft","paddingRight","overlayStyle","ellipsis","type","typeNameMap","SongView","song","paddingTop","description","count","backgroundColor","publish_date","float","meter","phrases","sort","a","b","songInfo","majorTonics","minorTonics","majorTonicsMap","minorTonicsMap","KeyModeView","highlight","statsMajor","statsMinor","calcStats","j","phrase","innerRadiusMajor","outerRadiusMajor","labelRadiusMajor","arcsMajor","arcMajor","innerRadius","outerRadius","arcLabelMajor","innerRadiusMinor","outerRadiusMinor","labelRadiusMinor","arcsMinor","arcMinor","arcLabelMinor","join","centroid","_","arr","opacity","least","most","colorMap","index","axisScale","MelodyView","each","path","getElementById","remove","stats","melody_pieces","k","converted","slice","exponent","random","parentNode","raise","labelRadius","arc","arcLabel","MeterView","testData","allValues","arcs","lines","endAngle","startAngle","ChordDurationView","chordDuration","sortedData","visData","otherData","otherSum","paths","allDurations","PitchRangeView","idList","ele","maxRange","I","X","Y","bins","thresholds","xDomain","x0","x1","yDomain","xScale","yScale","xAxis","tickSizeOuter","yAxis","select","clone","rects","allRanges","nodeId","ChordView","full","zoomed","transform","clicked","children","_children","parent","update","withinit","nodes","flatten","root","links","simulation","force","distance","strength","sizeScale","colorScale","link","linkGroup","exit","linkEnter","enter","merge","node","nodeGroup","nodeEnter","drag","source","nextProps","nextState","zoom","scaleExtent","sum","cp","concat","oriLength","currentRoot","shift","flag","processData","recurse","active","alphaTarget","restart","fx","fy","ChordViewFull","body","clientWidth","clientHeight","Logo","scale","xmlns","version","t","stroke","ry","rx","cy","cx","fill","loading1","indicator","LoadingOutlined","spin","tip","loading2","loading3","closebtn","size","notification","close","Main","dataFiltered","phraseFilter","modeFilter","songSelect","fullscreen","enterFullscreen","exitfull","showSelectorHelp","showHelp","showStatisticsHelp","showSongHelp","showChordProgressionHelp","showMelodyHelp","showKeyModeHelp","showPitchRangeHelp","showChordDurationHelp","showMeterHelp","onYearFilterChange","msg","filterData","onPhraseFilterChange","onModeFilterChange","onHighlightChange","h","onSongSelectChange","year","from","filtered","dataCopy","JSON","parse","stringify","songDate","newPhrases","AOS","init","duration","easing","delay","add","v","f","paras","axios","get","then","response","error","message","warn","server","yearFilterChangeSub","subscribe","phraseFilterChangeSub","modeFilterChangeSub","songSelectChangeSub","fullSub","showWelcome","open","key","icon","BulbOutlined","des","btn","onClose","QuestionCircleOutlined","unsubscribe","minHeight","Ribbon","FullscreenOutlined","paddingBottom","App","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.4113dca9.chunk.js","sourcesContent":["import { message } from \"antd\";\nimport axios from \"axios\";\nimport PubSub from \"pubsub-js\";\n\nvar env = 'staging'\n\nexport const themeColor = [\n    '#e6f7ff',\n    '#bae7ff',\n    '#91d5ff',\n    '#69c0ff',\n    '#40a9ff',\n    '#1890ff',\n    '#096dd9',\n    '#0050b3',\n    '#003a8c',\n    '#002766',\n    '#cae7ff'\n]\nvar prodServer = 'https://billyyi.top/api/popvis_back_end'\nvar stagingServer = 'http://localhost:5000';\nvar privateServer = 'http://localhost:3000/api/popvis_back_end';\nvar address\nif (env === 'prod'){\n    address = prodServer;\n}\nelse if (env === 'staging'){\n    address = stagingServer;\n}\nelse{\n    address = privateServer;\n}\nexport function server(add, obj, v, f=null, paras=null) {\n    axios.get(address + add).then(\n        response => { \n            obj.setState({\n                [v]:response.data\n            });\n            if (f !== null){\n                f(...paras)\n            }\n        },\n        error => { \n            message.warn('Sorry, something wrong happened to the server!')\n            console.log(error)\n        },\n    )\n};\nexport function fullScreen() {\n    var element = document.documentElement;\n    if (element.requestFullscreen) {\n        element.requestFullscreen();\n    } else if (element.msRequestFullscreen) {\n        element.msRequestFullscreen();\n    } else if (element.mozRequestFullScreen) {\n        element.mozRequestFullScreen();\n    } else if (element.webkitRequestFullscreen) {\n        element.webkitRequestFullscreen();\n    }\n}\n\n// \nexport function exitFullscreen() {\n    if (document.exitFullscreen) {\n        document.exitFullscreen();\n    } else if (document.msExitFullscreen) {\n        document.msExitFullscreen();\n    } else if (document.mozCancelFullScreen) {\n        document.mozCancelFullScreen();\n    } else if (document.webkitExitFullscreen) {\n        document.webkitExitFullscreen();\n    }\n}\n\nwindow.onresize = function() {\n    var isFull=!!(document.webkitIsFullScreen || document.mozFullScreen || \n        document.msFullscreenElement || document.fullscreenElement\n    );\n    if (!isFull){\n        PubSub.publish('full', false)\n    }\n}\n\nexport const noteText = {\n    welcome:'POPVIS is a visualzation of the POP909 Dataset created by Music-X-Lab, NYU Shanghai. If you are confused about the design logic, you may find it helpful by clicking the view title or the card ribbon. For some views, you may click the button next to the view title to enter the fullscreen mode.',\n    selector:'The selector card enables you to filter phrases. It is combined by 3 parts. 1. The year-month brusher: this area chart represents the song number published in specific months. The x-axis is the years and months, and the y-axis is the amount of songs that published in the month. 2. The phrase selector: five kind of phrases are included: intro, verse, chorus, outro, and other phrases. If none is selected, then by default will show all phrases. 3. The mode selector: similar to the phrase selector, you can select major mode or minor mode. By default all modes will be shown.',\n    statistics:'The statistics card brings different statistics of the selected songs and phrases. On the left side is the song selector. When hovering on each songs, the song information will also be highlighted in some of the statistic views. If a song is clicked, the detailed information will be shown in the song card. (For more information, please refer to the user guid of the song card.) Type in the input frame on the top-left of the statistics card, you may filter the songs by artist or name. For informations about different views, please refer to the corresponding user guid (by clicking the views title).',\n    song:'The song card shows the detailed information of a song. To view it, you have to first click a song in the left side of the statistics card. The song information is represented by a flow of phrase cards. The phrase card in ordered from left to right, its horizontal position represents the actual phrase location in the song. The type of the phrase is represented by color hue, with the mapping relationship: light_orange: intro; orange: verse; blue: chorus; light_blue: outro; gray: other. The width of the phrase card represents the length of the phrase, measured in bars. Two kinds of height exists. Card with larger height means the phrase have vocal, cards with smaller height dont have a vocal track. You may also view the detailed information of a phrase by clicking the card. Clicking the chord progression in the card will play the chord progression. ',\n    chord:'The chord progression view is a force directed tree, the progressions are represented by the hierarchy of tree, the saturation and the size of a node is the popularity of the current progression. ',\n    melody:'The melody pieces view is a parallel coordinates chart that shows the popular melody pieces in the selected phrases. Melodies are sliced with each piece contains five notes. The coordinates from the left to the right shows the pitch of the first note to the fifth note. The thickness and the saturation shows the popularity of a specific melody piece. Hovering will show the tooltip.',\n    keyMode:'The pitch range view is a pie chart that shows the amount of each kind of key and mode in the selected phrases. The inner circle is all the minor tonics, while the outer circle is all the major tonics. The saturation represents the amount of a specific key and mode. ',\n    pitchRange:'The pitch range view is a histogram that shows the number of each kind of pitch range in the selected phrases. The x-axis is the pitch range and the y-axis is the amount. Hovering will show the tooltip of detailed information.',\n    chordDuration:'The chord duration view is a pie chart that shows the proportion of each kinds of chord durations in the selected phrases. Hovering will show the tooltip of detailed information.',\n    meter:'The meter view is a pie chart that shows the proportion of each kinds of meters in the selected phrases. Hovering will show the tooltip of detailed information.',\n}","import { Divider, Input } from 'antd'\nimport { SearchOutlined } from \"@ant-design/icons\";\nimport React, { Component } from 'react'\nimport './index.css'\nimport PubSub from 'pubsub-js'\n\nexport default class SongSelector extends Component {\n\n    \n    constructor(props){\n        super(props);\n        this.state = {\n            selected:null,\n            yearFilter:this.props.yearFilter,\n            displayed:this.props.data,\n            data:this.props.data,\n        }\n        this.searchInput = React.createRef()\n    }\n\n    UNSAFE_componentWillReceiveProps(props){\n        if (this.state.yearFilter !== props.yearFilter){\n            this.setState({ data:props.data, displayed:props.data, yearFilter:props.yearFilter });\n        }\n        else{\n            var value = this.searchInput.current.state.value;\n            if (value !== undefined){\n                this.setState({\n                    displayed:props.data.filter((item) => { \n                        return item.name.search(value) !== -1 || item.artist.search(value) !== -1 \n                    })\n                })\n            }\n        }\n    }\n\n    handelClick = (event) => {\n        this.setState({selected:event.target.id.split('-')[1]})\n        PubSub.publish('songSelectChange',event.target.id.split('-')[1])\n    }\n    handelMouseEnter = (event) => {\n        this.props.highlightChange(event.target.id.split('-')[1])\n    }\n    handelMouseLeave = () => {\n        this.props.highlightChange('-1')\n    }\n\n    search = (event) => {\n        this.setState({\n            displayed:this.props.data.filter((item) => { return item.name.search(event.target.value) !== -1 || item.artist.search(event.target.value) !== -1 })\n        })\n    }\n\n    render() {\n        return (\n            <div className='song-selector-root'>\n                <div className='song-selector-search' ><Input ref={this.searchInput} placeholder=\"Type name or artist\" prefix={<SearchOutlined style={{color:'rgba(135, 165, 189, 0.678)'}}/>} bordered={false} allowClear={true} style={{width:'100%'}} onChange={this.search}/></div>\n                <div style={{overflow: 'scroll', maxHeight: '800px'}}>\n                    {this.state.displayed.map((item,idx) => {\n                        if (idx < 11){\n                            return (\n                            <div \n                                key={`s-${item.id}`}\n                                id={`s-${item.id}`}\n                                data-aos-delay={idx*100}\n                                data-aos='zoom-in'\n                                data-aos-once={true}\n                                onClick={this.handelClick} \n                                onMouseEnter={this.handelMouseEnter} \n                                onMouseLeave={this.handelMouseLeave} \n                                className={item.id.toString() === this.state.selected ?'song-item-selected':'song-item'}>\n                                <p id={`s-${item.id}`} className='song-item-artist'>{item.artist}</p>\n                                <Divider id={`s-${item.id}`} style={{marginTop:'0px', marginBottom:'10px'}}/>\n                                <p id={`s-${item.id}`} className='song-item-title'>{item.name}</p>\n                            </div>\n                        )\n                        }\n                        else{\n                            return (\n                            <div \n                                key={`s-${item.id}`}\n                                id={`s-${item.id}`}\n                                onClick={this.handelClick} \n                                onMouseEnter={this.handelMouseEnter} \n                                onMouseLeave={this.handelMouseLeave} \n                                className={item.id.toString() === this.state.selected ?'song-item-selected':'song-item'}>\n                                <p id={`s-${item.id}`} className='song-item-artist'>{item.artist}</p>\n                                <Divider id={`s-${item.id}`} style={{marginTop:'0px', marginBottom:'10px'}}/>\n                                <p id={`s-${item.id}`} className='song-item-title'>{item.name}</p>\n                            </div>\n                        )\n                        }\n                        \n                    })}\n                </div>\n                \n            </div>\n        )\n    }\n}\n","import React from 'react';\nimport PubSub from 'pubsub-js';\nimport './index.css'\n\nexport default class PhraseSelector extends React.Component {\n\n    state = {\n        intro:false,\n        verse:false,\n        chorus:false,\n        outro:false,\n        other:false\n    }\n    handelClick = (event) => {\n        if (event.target.id === 'phrase-select-intro') {\n            this.publishFilter(!this.state.intro, this.state.verse, this.state.chorus, this.state.outro, this.state.other);\n            this.setState({intro:!this.state.intro});\n        }\n        else if (event.target.id === 'phrase-select-verse'){\n            this.publishFilter(this.state.intro, !this.state.verse, this.state.chorus, this.state.outro, this.state.other);\n            this.setState({verse:!this.state.verse});\n        }\n        else if (event.target.id === 'phrase-select-chorus'){\n            this.publishFilter(this.state.intro, this.state.verse, !this.state.chorus, this.state.outro, this.state.other);\n            this.setState({chorus:!this.state.chorus});\n        }\n        else if (event.target.id === 'phrase-select-outro'){\n            this.publishFilter(this.state.intro, this.state.verse, this.state.chorus, !this.state.outro, this.state.other);\n            this.setState({outro:!this.state.outro});\n        }\n        else{\n            this.publishFilter(this.state.intro, this.state.verse, this.state.chorus, this.state.outro, !this.state.other);\n            this.setState({other:!this.state.other});\n        }\n    }\n\n    publishFilter = (intro, verse, chorus, outro, other) => {\n        if (!intro &&  !verse && !chorus && !outro && !other){\n            PubSub.publish('phraseFilterChange', [true, true, true, true, true]);\n        }\n        else{\n            PubSub.publish('phraseFilterChange', [intro, verse, chorus, outro, other]);\n        }\n    }\n\n    render(){\n        return (\n            <div className='phrase-selector-root'>\n                <div style={{cursor:'pointer'}} onClick={this.handelClick} data-aos='flip-down' data-aos-delay={900} data-aos-once={true}>\n                    {this.state.intro ? \n                        <div className='phrase-selection phrase-selection-left-radius intro' id='phrase-select-intro'>Intro</div>\n                        :\n                        <div className='phrase-selection phrase-selection-left-radius not-selected' id='phrase-select-intro'>Intro</div>\n                    }\n                </div>\n                <div style={{cursor:'pointer'}} onClick={this.handelClick} data-aos='flip-down' data-aos-delay={1000} data-aos-once={true}>\n                    {this.state.verse ? \n                        <div className='phrase-selection verse' id='phrase-select-verse'>Verse</div>\n                        :\n                        <div className='phrase-selection not-selected' id='phrase-select-verse'>Verse</div>\n                    }\n                </div>\n                <div style={{cursor:'pointer'}}   onClick={this.handelClick} data-aos='flip-down' data-aos-delay={1100} data-aos-once={true}>\n                    {this.state.chorus ? \n                        <div className='phrase-selection chorus' id='phrase-select-chorus'>Chorus</div>\n                        :\n                        <div className='phrase-selection not-selected' id='phrase-select-chorus'>Chorus</div>\n                    }\n                </div>\n                <div style={{cursor:'pointer'}} onClick={this.handelClick} data-aos='flip-down' data-aos-delay={1200} data-aos-once={true}>\n                    {this.state.outro ? \n                        <div className='phrase-selection outro' id='phrase-select-outro' >Outro</div>\n                        :\n                        <div className='phrase-selection not-selected' id='phrase-select-outro' >Outro</div>\n                    }\n                </div>\n                <div style={{cursor:'pointer'}} onClick={this.handelClick} data-aos='flip-down' data-aos-delay={1300} data-aos-once={true}>\n                    {this.state.other ? \n                        <div className='phrase-selection phrase-selection-right-radius other' id='phrase-select-other'>Other</div>\n                        :\n                        <div className='phrase-selection phrase-selection-right-radius not-selected' id='phrase-select-other'>Other</div>\n                    }\n                </div>\n            </div>\n        )\n    }\n}\n","import React from 'react'\nimport PubSub from 'pubsub-js'\nimport './index.css'\n\nexport default class ModeSelector extends React.Component {\n\n    state = {\n        major:false,\n        minor:false\n    }\n    handelClick = (event) => {\n        if (event.target.id === 'mode-select-major') {\n            this.setState({major:!this.state.major});\n            this.publishFilter(!this.state.major, this.state.minor);\n        }\n        else{\n            this.setState({minor:!this.state.minor});\n            this.publishFilter(this.state.major, !this.state.minor);\n        }\n    }\n    publishFilter = (major, minor) => {\n        if (!major &&  !minor){\n            PubSub.publish('modeFilterChange', [true, true]);\n        }\n        else{\n            PubSub.publish('modeFilterChange', [major, minor]);\n        }\n    }\n    render(){\n        return (\n            <div className='mode-selector-root'>\n                <div style={{cursor:'pointer'}}  onClick={this.handelClick} data-aos='flip-up' data-aos-delay={1400} data-aos-once={true}>\n                    {this.state.major ? \n                        <div className='mode-selection mode-selection-left-radius major' id='mode-select-major'>Major</div>\n                        :\n                        <div className='mode-selection mode-selection-left-radius mode-not-selected' id='mode-select-major'>Major</div>\n                    }\n                </div>\n                <div style={{cursor:'pointer'}} onClick={this.handelClick} data-aos='flip-up' data-aos-delay={1500} data-aos-once={true}>\n                    {this.state.minor ? \n                        <div className='mode-selection mode-selection-right-radius minor' id='mode-select-minor'>Minor</div>\n                        :\n                        <div className='mode-selection mode-selection-right-radius mode-not-selected' id='mode-select-minor'>Minor</div>\n                    }\n                </div>\n            </div>\n        )\n    }\n}\n","import React, { Component } from 'react'\nimport * as d3 from \"d3\";\nimport PubSub from 'pubsub-js';\n\nconst margin={top:5, left:20,right:20,bottom:12}\nexport default class YearBrusher extends Component {\n\n    constructor(props){\n        super(props);\n        this.parseDate = d3.timeParse('%Y-%m');\n        this.formatDate = d3.timeFormat('%Y-%m');\n        this.preprocess();\n        this.xAxisScale = d3.scaleTime()\n                       .domain([new Date(this.minMonth), new Date(this.maxMonth)])\n                       .range([margin.left, 600-margin.right]);\n        this.yAxisScale = d3.scaleLinear()\n                       .domain([0, this.maxCount])\n                       .range([70-margin.bottom, margin.top]);\n    }\n\n    preprocess(){\n        var months = this.props.data.map((item)=>{\n            return this.parseDate(item.publish_year.toString() +'-'+ item.publish_month.toString());\n        })\n        this.minMonth = Math.min.apply(null,months);\n        this.maxMonth = Math.max.apply(null,months);\n        var monthsStats = months.reduce((obj, month) => { \n            if (month.getTime() in obj) {\n                obj[month.getTime()] ++\n            } \n            else {\n                obj[month.getTime()] = 1\n            }\n            return obj\n        }, {})\n        this.maxCount = Math.max.apply(null, Object.values(monthsStats));\n        this.countPublishs = [];\n        var memo = {}\n        months.forEach(item => {\n            if (item.getTime() in memo){\n                return\n            }\n            else{\n                this.countPublishs.push([item,monthsStats[item.getTime()]])\n                memo[item.getTime()] = 1\n            }\n        })\n    }\n\n    componentDidMount(){\n        \n        this.svg = d3.select('#year-brusher-svg')\n                    .on(\"touchstart\", event => event.preventDefault())\n                    .on(\"pointermove\", this.pointermoved)\n                    .on('mouseenter', this.mouseEnter)\n                    .on('mouseleave', this.mouseLeave);\n                     \n        this.svg.append(\"g\")\n                .attr(\"transform\", `translate(0,${70-margin.bottom})`)\n                .call(d3.axisBottom(this.xAxisScale).ticks(d3.timeYear.every(3)).tickSize(4))\n                .call(g => g.selectAll(\".tick line\")\n                            .attr(\"stroke\", '#777777'))\n                .call(g => g.selectAll(\".domain\")\n                            .attr(\"stroke\", '#777777'))\n                .call(g => g.selectAll(\".tick text\")\n                            .attr(\"fill\", '#777777')\n                            .attr(\"font-size\", '5px'))\n        \n        this.svg.append(\"path\")\n                .attr('id','year-brusher-selected')\n                .attr(\"fill\", \"url('#myGradient-selected')\")\n                .datum(this.countPublishs)\n                .attr(\"d\", this.area(this.xAxisScale, this.yAxisScale));\n                                \n\n        this.svg.append(\"path\")\n                .attr('id','year-brusher-other')\n                .attr(\"fill\", \"url('#myGradient-other')\")\n                .datum([])\n                .attr(\"d\", this.area(this.xAxisScale, this.yAxisScale))\n                \n        this.rule = this.svg.append(\"g\");\n        this.rule.append(\"line\")\n                 .attr(\"y1\", margin.top+5)\n                 .attr(\"y2\", 70 - margin.bottom)\n                 .attr(\"stroke\", \"#777777\")\n                 .attr('stroke-width','0.5px')\n                 .attr('opacity','0');\n        this.rule.append(\"line\")\n                 .attr(\"y1\", margin.top+5)\n                 .attr(\"y2\", margin.top+5)\n                 .attr(\"x1\", 0)\n                 .attr(\"x2\", 20)\n                 .attr(\"stroke\", \"#777777\")\n                 .attr('stroke-width','0.5px')\n                 .attr('opacity','0');\n        \n        this.tooltip = this.svg.append(\"text\")\n                         .attr(\"y\", 8)\n                         .attr('font-size','6px')\n                         .attr('fill','#777777')\n                         .attr('opacity','0');\n        \n        this.svg.append(\"g\")\n                .call(d3.brushX()\n                        .extent([[margin.left, margin.top+5], [600 - margin.right, 70 - margin.bottom]])\n                        .on('brush', this.brushed)\n                        .on(\"end\", this.brushended));\n        \n        PubSub.publish('yearFilterChange', [new Date(this.minMonth), new Date(this.maxMonth)]);\n    }\n    area = (x, y) => {\n        return d3.area()\n                 .x(d => x(d[0]))\n                 .y0(y(0))\n                 .y1(d => y(d[1]))\n                 .curve(d3.curveBasis);\n    }\n\n    brushed = (event) =>{\n        // if (event.selection){\n        //     var start = this.xAxisScale.invert(event.selection[0])\n        //     var end = this.xAxisScale.invert(event.selection[1])\n        //     var selectedData = this.countPublishs.filter((item) => {\n        //         return item[0] >= start && item[0] <= end;\n        //     })\n        //     var otherData = this.countPublishs.filter((item) => {\n        //         return item[0] < start || item[0] > end;\n        //     })\n        //     console.log(selectedData);\n        //     var elem = document.getElementById(\"year-brusher-selected\"); \n        //     if (elem !== null){ elem.parentNode.removeChild(elem); }\n        //     elem = document.getElementById(\"year-brusher-other\"); \n        //     if (elem !== null){ elem.parentNode.removeChild(elem); }\n        //     this.svg.append(\"path\")\n        //             .attr('id','year-brusher-selected')\n        //             .attr(\"fill\", \"url('#myGradient-selected')\")\n        //     this.svg.append(\"path\")\n        //             .attr('id','year-brusher-other')\n        //             .attr(\"fill\", \"url('#myGradient-other')\")\n                                \n        // }\n    }\n\n    brushended = (event) => {\n        if (event.selection){\n            var start = this.xAxisScale.invert(event.selection[0])\n            var end = this.xAxisScale.invert(event.selection[1])\n            PubSub.publish('yearFilterChange', [start, end]);\n        }\n        else{\n            PubSub.publish('yearFilterChange', [new Date(this.minMonth), new Date(this.maxMonth)]);\n        }\n    }\n    pointermoved = (event) => {\n        var xPosition = d3.pointer(event)[0];\n        this.rule.attr(\"transform\", `translate(${xPosition},0)`);\n        var xText = this.formatDate(this.xAxisScale.invert(xPosition))\n        if (this.tooltip.attr('text') !== xText){\n            this.tooltip\n                .attr('x',xPosition)\n                .attr('text', xText)\n                .text(xText);\n        }\n    }\n    mouseEnter = () => {\n        this.rule.selectAll('line').attr('opacity','1');\n        this.tooltip.attr('opacity','1');\n    }\n    mouseLeave = () => {\n        this.rule.selectAll('line').attr('opacity','0');\n        this.tooltip.attr('opacity','0');\n    }\n\n    render() {\n        return (\n            <div id='year-brusher-svg-parent-div'>\n                <svg id='year-brusher-svg' width='100%' height='100%' viewBox='0 0 600 70' preserveAspectRatio=\"none\">\n                    <defs>\n                        <linearGradient id=\"myGradient-selected\" gradientTransform=\"rotate(90)\">\n                            <stop offset=\"30%\" stopColor=\"rgb(52, 105, 203)\" stopOpacity='1' />\n                            <stop offset=\"100%\"  stopColor=\"rgb(52, 105, 203)\" stopOpacity='0.1'/>\n                            \n                        </linearGradient>\n\n                        <linearGradient id=\"myGradient-other\" gradientTransform=\"rotate(90)\">\n                            <stop offset=\"30%\" stopColor=\"rgb(52, 0, 203)\" stopOpacity='1' />\n                            <stop offset=\"100%\"  stopColor=\"rgb(52, 0, 203)\" stopOpacity='0.1'/>\n                            \n                        </linearGradient>\n                    </defs>\n                </svg>\n            </div>\n        )\n    }\n}\n","import { Statistic, Tooltip, Typography } from 'antd';\nimport React, { Component } from 'react';\nimport './index.css';\nconst { Text } = Typography\nconst tonicMap = { 0:'C',1:'D',2:'D',3:'E',4:'E',5:'F',6:'F',7:'G',8:'A',9:'A',10:'B',11:'B' }\nconst modeMap = { maj:' Major', min:' Minor' }\nexport default class PhraseItem extends Component {\n\n    state = {playing:'stop'}\n\n    changeDisplay = () => {\n        if (this.props.displayed === false){\n            this.props.changeDisplay(this.props.id)\n        }\n    }\n    collapse = () => {\n        this.props.changeDisplay('-1');\n    }\n    testVocal = () => {\n        return /[A-Z]/.test(this.props.label) ? 'has-vocal':'no-vocal'\n    }\n    testVocalUI = () => {\n        return /[A-Z]/.test(this.props.label) ? 'Vocal ':'Instrumental '\n    }\n    getProgression = () => {\n        var progressionStr = ''\n        for (var i=0; i < this.props.item.chord_progression.length; i++){\n            progressionStr = progressionStr + ' - ' + this.props.item.chord_progression[i]\n        }\n        console.log(progressionStr)\n        return progressionStr.substring(2)\n    }\n    play = (e) =>{\n        if (this.state.playing === 'stop'){\n            this.mp3 = new Audio(`/api/popvis_back_end/chordprogression/${this.props.songId}/${this.props.id}`);\n            this.mp3.play();\n            this.mp3.addEventListener('ended', (event) => {\n                this.setState({\n                        playing:'stop'\n                    })\n                });\n            this.setState({\n                playing:'playing'\n            })\n        }\n        else if (this.state.playing === 'pause'){\n            this.mp3.play();\n            this.setState({\n                playing:'playing'\n            })\n        }\n        else if (this.state.playing === 'playing'){\n            this.setState({\n                playing:'pause'\n            })\n            this.mp3.pause();\n        }\n    }\n\n    render() {\n        return (\n            <div data-aos=\"flip-left\" data-aos-delay={parseInt(this.props.id)*50} data-aos-once={true} style={{display:'inline-block'}}>\n                <Tooltip title={`${this.testVocalUI()}${mapType(this.props.label)} with ${this.props.length} bars`}>\n                \n                {this.props.displayed ? \n                    <div className={`song-display-phrase-item song-display-phrase-item-${mapType(this.props.label)}`} style={{\n                        minWidth: '400px', maxWidth: '400px',\n                    }} onClick={this.changeDisplay}>\n                        <div data-aos='fade-in-out' data-aos-duration={400} data-aos-once={true}>\n                            <Tooltip title={'Click to Collapse'} placement='bottom'><h1 className='phrase-item-title' onClick={this.collapse}>{mapTypeCap(this.props.label) + ' Phrase'}</h1></Tooltip>\n                            <p>\n                                <Statistic title={<div style={{lineHeight:'5px'}}>Length</div>} \n                                    value={this.props.length + ' Bars'} \n                                    valueStyle={{color:'rgba(0,0,0,0.7)', fontFamily:'zillaslab,palatino,\"Palatino Linotype\",serif'}} \n                                    style={{display:'inline-block', width:'45%', marginLeft:'5%'}} />\n                                <Statistic title={<div style={{lineHeight:'5px'}}>Tonic/Mode</div>} \n                                    value={tonicMap[this.props.item.tonic] + ' ' + modeMap[this.props.item.mode]} \n                                    valueStyle={{color:'rgba(0,0,0,0.7)', fontFamily:'zillaslab,palatino,\"Palatino Linotype\",serif'}} \n                                    style={{display:'inline-block', width:'45%', marginRight:'5%'}} />\n                            </p>\n                            <p>\n                                <Statistic title={<div style={{lineHeight:'5px'}}>Chord Duration</div>} \n                                    value={this.props.item.chord_duration + ' Quarters'} \n                                    valueStyle={{color:'rgba(0,0,0,0.7)', fontFamily:'zillaslab,palatino,\"Palatino Linotype\",serif'}} \n                                    style={{display:'inline-block',width:'45%', marginLeft:'5%'}} />\n                                <Statistic title={<div style={{lineHeight:'5px'}}>Pitch Range</div>} \n                                    value={this.props.item.pitch_range} \n                                    valueStyle={{color:'rgba(0,0,0,0.7)', fontFamily:'zillaslab,palatino,\"Palatino Linotype\",serif'}} \n                                    style={{display:'inline-block',width:'45%', marginRight:'5%'}} />\n                            </p>\n                            <div style={{textAlign:'center',fontSize:'20px', color:'rgba(0,0,0,0.7)',transition:'0.5s', paddingLeft:'8%', paddingRight:'8%'}}>\n                            <Tooltip placement='bottom' title={'Click to play chord progression: ' + this.getProgression()}\n                            overlayStyle={{maxWidth:'500px'}}>\n                                <Text ellipsis={true} onClick={this.play} style={{color:this.state.playing==='playing'? 'green':'black'}}>{this.getProgression()}</Text>\n                            </Tooltip>\n                            </div>\n                        </div>\n                    </div>\n                    :\n                    <div className={`song-display-phrase-item song-display-phrase-item-${mapType(this.props.label)} ${this.testVocal()}`} style={{\n                        minWidth: 0.4*(this.props.length * 50) + 'px', maxWidth: 0.4*(this.props.length * 50) + 'px',\n                    }} onClick={this.changeDisplay}>\n                    <h1 className='phrase-item-title trans'>&nbsp;</h1>\n                    </div>\n                }\n                </Tooltip>\n            </div>\n        )\n    }\n}\nfunction mapType(type){\n    const typeNameMap = {\n        'i':'intro','I':'intro','a':'verse','A':'verse','b':'chorus','B':'chorus','o':'outro','O':'outro', \n    }\n    if (type in typeNameMap){\n        return typeNameMap[type]\n    }\n    else{\n        return 'other'\n    }\n}\nfunction mapTypeCap(type){\n    const typeNameMap = {\n        'i':'Intro','I':'Intro','a':'Verse','A':'Verse','b':'Chorus','B':'Chorus','o':'Outro','O':'Outro', \n    }\n    if (type in typeNameMap){\n        return typeNameMap[type]\n    }\n    else{\n        return 'Other'\n    }\n}\n\n","import React, { Component } from 'react'\nimport { Badge, Statistic, Empty } from 'antd';\nimport { themeColor } from '../utils';\nimport PhraseItem from '../PhraseItem';\nimport './index.css'\nconst tonicMap = { 0:'C',1:'D',2:'D',3:'E',4:'E',5:'F',6:'F',7:'G',8:'A',9:'A',10:'B',11:'B' }\nconst modeMap = { maj:' Major', min:' Minor' }\nexport default class SongView extends Component {\n\n    state = {song:'waiting', display:'-1'}\n    static getDerivedStateFromProps(props, state){\n        var songInfo\n        if (props.song === null || props.song === '-1'){\n            songInfo = 'waiting'\n        }\n        for (var i = 0; i < props.data.length; i++){\n            if (props.data[i].id.toString() === props.song){\n                songInfo = props.data[i]\n            }\n        }\n        if (songInfo !== state.song){\n            return { song:songInfo, display:'-1' }\n        }\n    }\n    changeDisplay = (id) => {\n        this.setState({display:id.toString()});\n    }\n    render() {\n        return (\n            <div>\n                {this.state.song === 'waiting' || this.state.song === undefined ? <Empty style={{paddingTop:'80px'}} description='Please select a song to view detailed information.'/>:\n                    <div style={{marginLeft:'5%', marginRight:'5%', paddingTop:'30px'}}>\n                        <div className='song-info'>\n                            <div className='song-title'>\n                                {this.state.song.name}\n                                <Badge count={`${this.state.song.artist}`} style={{ backgroundColor: themeColor[8],marginLeft:'5px' }}/>\n                            </div>\n                            <Statistic title={<div style={{lineHeight:'5px'}}>Publish Date</div>} value={this.state.song.publish_date} style={{float:'right', marginLeft:'5%'}}/>\n                            <Statistic title={<div style={{lineHeight:'5px'}}>Meter</div>} value={this.state.song.meter} style={{float:'right', marginLeft:'5%'}} />\n                            <Statistic title={<div style={{lineHeight:'5px'}}>Initial Tonic/Mode</div>} value={tonicMap[this.state.song.phrases[0].tonic] + modeMap[this.state.song.phrases[0].mode]} style={{float:'right', marginLeft:'5%'}} />\n                        </div>\n                        <div className='song-display-divider'></div>\n                        <div className='song-structure'>\n                        <div style={{ minWidth:'1%', display:'inline-block'}}><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p></div>\n                        {this.state.song.phrases.sort((a, b)=>{\n                            return a.id - b.id\n                        }).map((item)=>{\n                            return <PhraseItem songId= {this.state.song.id} item={item} displayed={this.state.display === item.id.toString()} length={item.length} label={item.label} id={item.id} changeDisplay={idx => {return this.changeDisplay(idx)}}></PhraseItem>\n                        })}\n                        </div>\n                    </div>\n                }\n            </div>\n        )\n        \n    }\n}\n","import React, { Component } from 'react'\nimport './index.css'\nimport * as d3 from 'd3'\n\nconst width = 500;\nconst height = 360;\nconst majorTonics = ['C','G','D', 'A', 'E', 'B/C', 'F/G', 'C/D', 'A', 'E', 'B', 'F']\nconst minorTonics = ['a','e','b', 'f', 'c', 'g/a', 'd/e', 'a/b', 'f', 'c', 'g', 'd']\nconst majorTonicsMap = {0:0, 1:7, 2:2, 3:9, 4:4, 5:11, 6:6, 7:1, 8:8,9:3,10:10, 11:5}\nconst minorTonicsMap = {0:9, 1:4, 2:11, 3:6, 4:1, 5:8, 6:3,7:10, 8:5, 9:0, 10:7, 11:2}\nexport default class KeyModeView extends Component {\n\n    state = {\n        data: this.props.data,\n        highlight:'-1',\n        statsMajor:[0,0,0,0,0,0,0,0,0,0,0,0],\n        statsMinor:[0,0,0,0,0,0,0,0,0,0,0,0],\n    }\n\n    static getDerivedStateFromProps(props, state){\n        var least, most, colorMap, song\n        if (props.data !== state.data){\n            var statsMajor = [0,0,0,0,0,0,0,0,0,0,0,0]\n            var statsMinor = [0,0,0,0,0,0,0,0,0,0,0,0]\n            for (var i=0; i<props.data.length; i++){\n                song = props.data[i];\n                for (var j=0; j<song.phrases.length; j++){\n                    var phrase = song.phrases[j]\n                    if (phrase.mode === 'maj'){\n                        statsMajor[majorTonicsMap[phrase.tonic]] ++;\n                        }\n                    else{\n                        statsMinor[minorTonicsMap[phrase.tonic]] ++;\n                    }\n                }\n            }\n            least = Math.min(Math.min.apply(null, statsMajor),  Math.min.apply(null, statsMinor))\n            most = Math.max(Math.max.apply(null, statsMajor),  Math.max.apply(null, statsMinor))\n            colorMap = d3.scaleLinear().domain([least,most]).range([0.1,0.9])\n            d3.selectAll('.key-note-view-major-path')\n                .attr(\"fill\", (d,i) => d3.interpolateBlues(colorMap(statsMajor[i])))\n                .on(\"mouseover\",function(e,d){\n                    d3.select(this).attr(\"fill\",\"orange\");\n                    d3.select('#key-mode-tooltip').attr('opacity', '1').text(d.data + ': ' + statsMajor[d.index] + ' Phrases')\n                })\n                .on(\"mouseout\",function(e,d){\n                    d3.select(this).attr(\"fill\",d3.interpolateBlues(colorMap(statsMajor[d.index])));\n                    d3.select('#key-mode-tooltip').attr('opacity', '0')\n                })\n            d3.selectAll('.key-note-view-minor-path')\n                .attr(\"fill\", (d,i) => d3.interpolateBlues(colorMap(statsMinor[i])))\n                .on(\"mouseover\",function(e,d){\n                    d3.select(this).attr(\"fill\",\"orange\");\n                    d3.select('#key-mode-tooltip').attr('opacity', '1').text(d.data + ': ' + statsMinor[d.index] + ' Phrases')\n                })\n                .on(\"mouseout\",function(e,d){\n                    d3.select(this).attr(\"fill\",d3.interpolateBlues(colorMap(statsMinor[d.index])));\n                    d3.select('#key-mode-tooltip').attr('opacity', '0')\n                })\n            return {data:props.data, statsMinor:statsMinor, statsMajor:statsMajor}\n        }\n        if (props.highlight !== state.highlight){\n            least = Math.min(Math.min.apply(null, state.statsMajor),  Math.min.apply(null, state.statsMinor))\n            most = Math.max(Math.max.apply(null, state.statsMajor),  Math.max.apply(null, state.statsMinor))\n            colorMap = d3.scaleLinear().domain([least,most]).range([0.1,0.9])\n            song = state.data.filter((item) => item.id.toString() === props.highlight)\n            if (song.length !== 1){\n                d3.selectAll('.key-note-view-major-path')\n                    .attr(\"fill\", (d,i) => {\n                        return d3.interpolateBlues(colorMap(state.statsMajor[i]));\n                    });\n                d3.selectAll('.key-note-view-minor-path')\n                    .attr(\"fill\", (d,i) => {\n                        return d3.interpolateBlues(colorMap(state.statsMinor[i]));\n                    });\n                return {data:props.data,highlight:props.highlight}\n            }\n            if (song[0].phrases[0] !== undefined){\n                var map = song[0].phrases[0].mode === 'maj'? majorTonicsMap : minorTonicsMap\n                var index = map[song[0].phrases[0].tonic]\n                if (song[0].phrases[0].mode === 'maj'){\n                    d3.selectAll('.key-note-view-major-path')\n                        .attr(\"fill\", (d,i) => {\n                            return i === index ? 'orange': d3.interpolateBlues(colorMap(state.statsMajor[i]));\n                        });\n                    d3.selectAll('.key-note-view-minor-path')\n                        .attr(\"fill\", (d,i) => {\n                            return d3.interpolateBlues(colorMap(state.statsMinor[i]));\n                        });\n                }\n                else{\n                    d3.selectAll('.key-note-view-major-path')\n                        .attr(\"fill\", (d,i) => {\n                            return d3.interpolateBlues(colorMap(state.statsMajor[i]));\n                        });\n                    d3.selectAll('.key-note-view-minor-path')\n                        .attr(\"fill\", (d,i) => {\n                            return i === index ? 'orange': d3.interpolateBlues(colorMap(state.statsMinor[i]));\n                        });\n                }\n            }\n            else{\n                d3.selectAll('.key-note-view-major-path')\n                        .attr(\"fill\", (d,i) => {\n                            return d3.interpolateBlues(colorMap(state.statsMajor[i]));\n                        });\n                d3.selectAll('.key-note-view-minor-path')\n                        .attr(\"fill\", (d,i) => {\n                            return d3.interpolateBlues(colorMap(state.statsMinor[i]));\n                        });\n            }\n            \n        }\n        return {highlight:props.highlight}\n    }\n\n    calcStats = (data) => {\n\n        var statsMajor = [0,0,0,0,0,0,0,0,0,0,0,0]\n        var statsMinor = [0,0,0,0,0,0,0,0,0,0,0,0]\n        for (var i=0; i<data.length; i++){\n            var song = data[i];\n            for (var j=0; j<song.phrases.length; j++){\n                var phrase = song.phrases[j]\n                if (phrase.mode === 'maj'){\n                    statsMajor[majorTonicsMap[phrase.tonic]] ++;\n                    }\n                else{\n                    statsMinor[minorTonicsMap[phrase.tonic]] ++;\n                }\n            }\n        }\n        return [statsMajor, statsMinor]\n    }\n\n    componentDidMount(){\n\n        const innerRadiusMajor = Math.min(width, height) / 3;\n        const outerRadiusMajor = Math.min(width, height) / 2;\n        const labelRadiusMajor = (innerRadiusMajor + outerRadiusMajor) / 2;\n        const arcsMajor = d3.pie().value(1)(majorTonics);\n        const arcMajor = d3.arc().innerRadius(innerRadiusMajor).outerRadius(outerRadiusMajor);\n        const arcLabelMajor = d3.arc().innerRadius(labelRadiusMajor).outerRadius(labelRadiusMajor);\n\n        const innerRadiusMinor = Math.min(width, height) / 6;\n        const outerRadiusMinor = Math.min(width, height) / 3;\n        const labelRadiusMinor = (innerRadiusMinor + outerRadiusMinor) / 2;\n        const arcsMinor = d3.pie().value(1)(minorTonics);\n        const arcMinor = d3.arc().innerRadius(innerRadiusMinor).outerRadius(outerRadiusMinor);\n        const arcLabelMinor = d3.arc().innerRadius(labelRadiusMinor).outerRadius(labelRadiusMinor);\n\n        this.svg = d3.select(\"#key-mode-svg\");\n\n        this.svg.append(\"g\")\n                .attr('transform', 'translate(258,200)')\n                .attr(\"stroke\", 'white')\n                .attr(\"stroke-width\", '1px')\n                .attr(\"stroke-linejoin\", 'round')\n                .selectAll(\"path\")\n                .data(arcsMajor)\n                .join(\"path\")\n                .attr('class','key-note-view-major-path')\n                .attr('data-aos','zoom-in')\n                .attr('data-aos-delay',(d,i) => `${i*100+600+300}`)\n                .attr(\"d\", arcMajor)\n                .append(\"title\")\n                .text(d => d.data);\n        this.svg.append(\"g\")\n                .attr('transform', 'translate(258,200)')\n                .attr(\"stroke\", 'white')\n                .attr(\"stroke-width\", '1px')\n                .attr(\"stroke-linejoin\", 'round')\n                .selectAll(\"path\")\n                .data(arcsMinor)\n                .join(\"path\")\n                .attr('class','key-note-view-minor-path')\n                .attr('data-aos','zoom-in')\n                .attr('data-aos-delay',(d,i) => `${i*100+300}`)\n                .attr(\"d\", arcMinor)\n                .append(\"title\")\n                .text(d => d.data);\n\n        this.svg.append(\"g\")\n                .attr('transform', 'translate(258,205)')\n                .attr(\"font-family\", \"sans-serif\")\n                .attr(\"font-size\", 14)\n                .attr(\"text-anchor\", \"middle\")\n                .selectAll(\"text\")\n                .data(arcsMajor)\n                .join(\"text\")\n                    .attr(\"transform\", d => `translate(${arcLabelMajor.centroid(d)})`)\n                .selectAll(\"tspan\")\n                .data(d => d.data)\n                .join(\"tspan\")\n                    .attr(\"x\", (_, i, arr) => `${(i - arr.length/2+ 0.5) * 0.7}em`)\n                    .attr(\"y\", 0)\n                    .attr(\"font-weight\", (_, i) => i ? null : \"bold\")\n                    .text(d => d);\n        this.svg.append(\"g\")\n                .attr('transform', 'translate(258,205)')\n                .attr(\"font-family\", \"sans-serif\")\n                .attr(\"font-size\", 12)\n                .attr(\"text-anchor\", \"middle\")\n                .selectAll(\"text\")\n                .data(arcsMinor)\n                .join(\"text\")\n                .attr(\"transform\", d => `translate(${arcLabelMinor.centroid(d)})`)\n                .selectAll(\"tspan\")\n                .data(d => d.data)\n                .join(\"tspan\")\n                    .attr(\"x\", (_, i, arr) => `${(i - arr.length/2+ 0.5) * 0.7}em`)\n                    .attr(\"y\", 0)\n                    .attr(\"font-weight\", (_, i) => i ? null : \"bold\")\n                    .text(d => d);\n    }\n\n    render() {\n        return (\n            <div id='key-mode-svg-parent-div'>\n                <svg id='key-mode-svg' width='100%' height='100%' viewBox='0 0 525 380' preserveAspectRatio=\"none\">\n                <text id='key-mode-tooltip' x='20' y='380' opacity='0'></text>\n                <text  x='215' y='190' opacity='1' fontSize='12px'>Outer for Major</text>\n                <text  x='215' y='205' opacity='1' fontSize='12px'>Inner for Minor</text>\n                </svg>\n            </div>\n        )\n    }\n}\n","import React, { Component } from 'react';\nimport * as d3 from 'd3'\n\nconst height = 430;\nconst margin = {top:50, left:20, right:20, bottom:50}\nconst axisScale = d3.scaleLinear().domain([1,7]).range([height-margin.bottom-10, margin.top]);\nexport default class MelodyView extends Component {\n\n    state = {\n        data:this.props.data\n    }\n\n    static getDerivedStateFromProps(props, state){\n        if (props.data !== undefined && props.data !== state.data){\n            var path=document.getElementById(\"melody-path\");\n            if (path !== undefined && path !== null){\n                path.remove();\n            }\n            var stats = {};\n            for (var i=0; i<props.data.length; i++){\n                var phrases = props.data[i].phrases;\n                for (var j=0; j<phrases.length; j++){\n                    var melody_pieces = phrases[j].melody_pieces;\n                    for (let k in melody_pieces){\n                        if (k in stats){\n                            stats[k] = stats[k] + melody_pieces[k];\n                        }\n                        else{\n                            stats[k] = melody_pieces[k];\n                        }\n                    }\n                }\n            }\n            var converted = [];\n            for (let i in stats){\n                converted.push([i,stats[i]]);\n            }\n            converted = d3.sort(converted, (a, b) => d3.ascending(b[1], a[1])).slice(0,30);\n            var colorMap = d3.scalePow().exponent(1).domain([converted[0][1],converted[converted.length-1][1]]).range([0,1])\n            var svg = d3.select('#melody-svg');\n            svg.append(\"g\")\n                .attr('id', 'melody-path')\n               .attr(\"fill\", \"none\")\n               .attr(\"stroke-width\", 1.5)\n               .selectAll(\"path\")\n               .data(converted)\n               .join(\"g\")\n               .attr(\"transform\", d => `translate(0,${(Math.random()-0.5)*10})`)\n               .append(\"path\")\n               .attr('data-aos', 'fade-zoom-in')\n               .attr('data-aos-delay', (d,idx) => `${idx*50}`)\n               .attr(\"stroke\", d => d3.interpolateBlues(colorMap(d[1])))\n               .attr(\"stroke-width\", d => colorMap(d[1]) * 4)\n               .attr('stroke-opacity','0.5')\n               .attr(\"d\", d => d3.line()([\n                   [65, axisScale(d[0][0])],\n                   [65+80*1, axisScale(d[0][1])],\n                   [65+80*2, axisScale(d[0][2])],\n                   [65+80*3, axisScale(d[0][3])],\n                   [65+80*4, axisScale(d[0][4])],\n                ]\n               ))\n               .on(\"mouseover\",function(e,d){\n                    d3.select(this).attr(\"stroke\",\"orange\").attr(\"stroke-width\", 6).attr('stroke-opacity','1');\n                    d3.select(this.parentNode).raise();\n                    d3.select('#melody-tooltip').attr('opacity', '1').text(`${d[0]}: Appears ${d[1]} times`);\n                })\n                .on(\"mouseout\",function(e,d){\n                    d3.select(this).attr(\"stroke\",d3.interpolateBlues(colorMap(d[1]))).attr('stroke-opacity','0.5').attr(\"stroke-width\", d => colorMap(d[1]) * 4);\n                    d3.select('#melody-tooltip').attr('opacity', '0');\n                })\n               .append(\"title\")\n               .text(d => d.name);\n        }\n            \n        return {data:props.data}\n    }\n\n    componentDidMount(){\n        this.svg = d3.select('#melody-svg');\n\n        const keys = ['1st', '2nd', '3rd', '4th', '5th']\n        this.svg.append(\"g\")\n            .selectAll(\"g\")\n            .data(keys)\n            .join(\"g\")\n            .attr(\"transform\", (d,idx) => `translate(${idx*80+65},0)`)\n            .each(function(d) { d3.select(this).call(d3.axisLeft(axisScale).ticks(7))\n                                               .call(g => g.selectAll(\".tick line\")\n                                                           .attr(\"stroke\", '#777777'))\n                                               .call(g => g.selectAll(\".domain\")\n                                                           .attr(\"stroke\", '#777777')); })\n            .call(g => g.append(\"text\")\n                .attr(\"x\", -10)\n                .attr(\"y\", height-margin.bottom+10)\n                .attr(\"text-anchor\", \"start\")\n                .attr(\"fill\", \"currentColor\")\n                .text(d => d))\n            }\n\n    render() {\n        return (\n            <div id='melody-svg-parent-div'>\n                <svg id='melody-svg' width='100%' height='100%' viewBox='0 0 428 430' preserveAspectRatio=\"none\">\n                <text id='melody-tooltip' x='20' y='420' opacity='0'></text>\n                </svg>\n            </div>\n        )\n    }\n}\n","import React, { Component } from 'react'\nimport * as d3 from 'd3';\n\nconst width = 268;\nconst height = 197;\nconst margin = {top:20, left:10, right:10, bottom:20}\nconst innerRadius = 0;\nconst outerRadius = (Math.min(width, height)-margin.top-margin.bottom) / 2.2;\nconst labelRadius = (innerRadius * 0.4 + outerRadius * 0.6);\nconst arc = d3.arc().innerRadius(innerRadius).outerRadius(outerRadius);\nconst arcLabel = d3.arc().innerRadius(labelRadius).outerRadius(labelRadius);\nexport default class MeterView extends Component {\n\n    state = {\n        data:this.props.data,\n        highlight:this.props.highlight,\n        colorMap:null\n    }\n\n    static getDerivedStateFromProps(props, state){\n        if (props.data !== state.data){\n            var stats = {}\n            for (let i in props.data){\n                var meter = props.data[i].meter;\n                if (meter in stats){\n                    stats[meter] ++;\n                }\n                else{\n                    stats[meter] = 1;\n                }\n            }\n            var converted = [];\n            for (let i in stats){\n                converted.push([i, stats[i]])\n            }\n            var testData = converted;\n            var allValues = []\n            for (let i in testData){\n                allValues.push(testData[i][1])\n            }\n            var least = Math.min.apply(null, allValues);\n            var most = Math.max.apply(null, allValues);\n            const colorMap = d3.scaleLinear().domain([least,most]).range([0.3,0.6]);\n            const arcs = d3.pie().value(i => i[1])(testData);\n            var svg = d3.select('#meter-svg');\n            svg.append(\"g\")\n                .attr('transform','translate(130,110)')\n                .attr(\"stroke\", 'white')\n                .attr(\"stroke-width\", '1px')\n                .attr(\"stroke-linejoin\", 'round')\n                .selectAll(\"path\")\n                .data(arcs)\n                .join(\"path\")\n                .attr('class', 'meter-paths')\n                .attr(\"fill\", d => d3.interpolatePuBuGn(colorMap(d.data[1])))\n                .attr(\"d\", arc)\n                .attr('data-aos', 'zoom-in')\n                .attr('data-aos-delay', (d,idx) => `${idx*300}`)\n                .on(\"mouseover\",function(e,d){\n                    d3.select(this).attr(\"fill\",\"orange\");\n                    d3.select('#meter-tooltip').attr('opacity', '1').text(`${d.data[0]}: ${d.data[1]} Songs`)\n                })\n                .on(\"mouseout\",function(e,d){\n                    d3.select(this).attr(\"fill\",d3.interpolatePuBuGn(colorMap(d.data[1])));\n                    d3.select('#meter-tooltip').attr('opacity', '0')\n                })\n                .append(\"title\")\n                .text(d => d[0]);\n\n            svg.append(\"g\")\n                .attr('transform','translate(130,110)')\n                .attr(\"font-family\", \"sans-serif\")\n                .attr(\"font-size\", 10)\n                .attr(\"text-anchor\", \"middle\")\n                .selectAll(\"text\")\n                .data(arcs)\n                .join(\"text\")\n                .attr(\"transform\", d => `translate(${arcLabel.centroid(d)})`)\n                .selectAll(\"tspan\")\n                .data(d => {\n                    const lines = `${d.data[0]}`.split(/\\n/);\n                    return (d.endAngle - d.startAngle) > 0.25 ? lines : lines.slice(0, 1);\n                })\n                .join(\"tspan\")\n                .attr(\"x\", 0)\n                .attr(\"y\", (_, i) => `${i * 1.1}em`)\n                .attr(\"font-weight\", (_, i) => i ? null : \"bold\")\n                .text(d => d);\n                return {data:props.data, highlight: props.highlight, colorMap:colorMap}\n        }\n        if (props.highlight !== state.highlight){\n            var song = props.data.filter((item) => item.id.toString() === props.highlight)\n            if (song.length !== 1){\n                song = [{meter:-1}]\n            }\n            var paths = d3.selectAll('.meter-paths')\n            paths.attr(\"fill\", d => {\n                if (song[0].meter === d.data[0]){\n                    return 'orange'\n                }\n                else{\n                    return d3.interpolatePuBuGn(state.colorMap(d.data[1]))\n                }\n            })\n            return {data:props.data, highlight: props.highlight, colorMap:state.colorMap}\n        }\n    }\n\n    render() {\n        return (\n            <div id='meter-svg-parent-div'>\n                <svg id='meter-svg' width='100%' height='100%' viewBox='0 0 268 197' preserveAspectRatio=\"none\">\n                <text id='meter-tooltip' x='20' y='190' opacity='0'></text>\n                </svg>\n            </div>\n        )\n    }\n}\n","import React, { Component } from 'react'\nimport * as d3 from 'd3';\n\nconst width = 268;\nconst height = 197;\nconst margin = {top:20, left:10, right:10, bottom:20}\nconst innerRadius = 0;\nconst outerRadius = (Math.min(width, height)-margin.top-margin.bottom) / 2.2;\nconst labelRadius = (innerRadius * 0.4 + outerRadius * 0.6);\nconst arc = d3.arc().innerRadius(innerRadius).outerRadius(outerRadius);\nconst arcLabel = d3.arc().innerRadius(labelRadius).outerRadius(labelRadius);\nexport default class ChordDurationView extends Component {\n\n    state = {\n        data:this.props.data,\n        highlight:this.props.highlight,\n        colorMap:null\n    }\n\n    static getDerivedStateFromProps(props, state){\n        if (props.data !== state.data){\n            var stats = {}\n            for (let i in props.data){\n                for (let j in props.data[i].phrases){\n                    var chordDuration = props.data[i].phrases[j].chord_duration;\n                    if (chordDuration in stats){\n                        stats[chordDuration] ++;\n                    }\n                    else{\n                        stats[chordDuration] = 1;\n                    }\n                }\n            }\n            var converted = [];\n            for (let i in stats){\n                converted.push([i, stats[i]])\n            }\n            var sortedData = d3.sort(converted, (a, b) => d3.ascending(b[1], a[1]));\n            var visData = sortedData.slice(0,5);\n            var otherData = sortedData.slice(5,sortedData.length);\n            var otherSum = d3.sum(otherData, d => d[1])\n            var allValues = []\n            for (let i in visData){\n                allValues.push(visData[i][0])\n            }\n            var least = Math.min.apply(null, allValues);\n            var most = Math.max.apply(null, allValues);\n            const colorMap = d3.scaleLinear().domain([least,most]).range([0.2,0.7]);\n            visData.push(['other', otherSum])\n            const arcs = d3.pie().value(i => i[1])(visData);\n            var svg = d3.select('#chord-duration-svg');\n            svg.append(\"g\")\n                .attr('transform','translate(130,110)')\n                .attr(\"stroke\", 'white')\n                .attr(\"stroke-width\", '1px')\n                .attr(\"stroke-linejoin\", 'round')\n                .selectAll(\"path\")\n                .data(arcs)\n                .join(\"path\")\n                .attr('class', 'chord-duration-paths')\n                .attr(\"fill\", d => {\n                    if (d.data[0] === 'other'){\n                        return d3.interpolateGnBu(0)\n                    }\n                    return d3.interpolateGnBu(colorMap(d.data[0]))\n                })\n                .attr(\"d\", arc)\n                .attr('data-aos', 'zoom-in')\n                .attr('data-aos-delay', (d,idx) => `${idx*300}`)\n                .on(\"mouseover\",function(e,d){\n                    d3.select(this).attr(\"fill\",\"orange\");\n                    d3.select('#chord-duration-tooltip').attr('opacity', '1').text(`${d.data[0]}: ${d.data[1]} Phrases`)\n                })\n                .on(\"mouseout\",function(e,d){\n                    d3.select(this).attr(\"fill\", () => {\n                        if (d.data[0] === 'other'){\n                        return d3.interpolateGnBu(0)\n                        }\n                    return d3.interpolateGnBu(colorMap(d.data[0]))});\n                    d3.select('#chord-duration-tooltip').attr('opacity', '0')\n                })\n                .append(\"title\")\n                .text(d => d[0]);\n\n            svg.append(\"g\")\n                .attr('transform','translate(130,110)')\n                .attr(\"font-family\", \"sans-serif\")\n                .attr(\"font-size\", 10)\n                .attr(\"text-anchor\", \"middle\")\n                .selectAll(\"text\")\n                .data(arcs)\n                .join(\"text\")\n                .attr(\"transform\", d => `translate(${arcLabel.centroid(d)})`)\n                .selectAll(\"tspan\")\n                .data(d => {\n                    const lines = `${d.data[0]}`.split(/\\n/);\n                    return (d.endAngle - d.startAngle) > 0.25 ? lines : lines.slice(0, 1);\n                })\n                .join(\"tspan\")\n                .attr(\"x\", 0)\n                .attr(\"y\", (_, i) => `${i * 1.1}em`)\n                .attr(\"font-weight\", (_, i) => i ? null : \"bold\")\n                .text(d => d);\n                return {data:props.data, highlight: props.highlight, colorMap:colorMap}\n        }\n        if (props.highlight !== state.highlight){\n            var paths = d3.selectAll('.chord-duration-paths')\n            var song = props.data.filter((item) => item.id.toString() === props.highlight)\n            if  (song === undefined || song.length !== 1){\n                paths.attr(\"fill\", d =>  {\n                    if (d.data[0] === 'other'){\n                        return d3.interpolateGnBu(0)\n                    }\n                    return d3.interpolateGnBu(state.colorMap(d.data[0]))\n                })\n                return {data:props.data, highlight: props.highlight, colorMap:state.colorMap}\n            }\n            var allDurations = {}\n            for (let i in song[0].phrases){\n                allDurations[song[0].phrases[i].chord_duration] = song[0].phrases[i].chord_duration\n            }\n            paths.attr('fill', d => {\n                if (d.data[0] in allDurations){\n                    return 'orange'\n                }\n                if (d.data[0] === 'other'){\n                    return d3.interpolateGnBu(0)\n                }\n                return d3.interpolateGnBu(state.colorMap(d.data[0]))\n            })\n            return {data:props.data, highlight: props.highlight, colorMap:state.colorMap}\n        }\n    }\n\n    render() {\n        return (\n            <div id='chord-duration-svg-parent-div'>\n                <svg id='chord-duration-svg' width='100%' height='100%' viewBox='0 0 268 197' preserveAspectRatio=\"none\">\n                <text id='chord-duration-tooltip' x='20' y='190' opacity='0'></text>\n                </svg>\n            </div>\n        )\n    }\n}\n","import React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport { themeColor } from '../utils';\n\nconst width = 535;\nconst height = 197;\nconst margin = {top:40, left:50, right:30, bottom:20}\nexport default class PitchRangeView extends Component {\n\n    state = {\n        data:this.props.data,\n        highlight:this.props.highlight\n    }\n\n    static getDerivedStateFromProps(props, state){\n        if (props.data !== state.data){\n            remove(['pitch-range-view-axis','pitch-range-view-rect','pitch-range-view-label']);\n            var stats = []\n            for (let i in props.data){\n                for (let j in props.data[i].phrases){\n                    var range = props.data[i].phrases[j].pitch_range;\n                    stats.push(range)\n                }\n            }\n            var converted = [];\n            for (let i in stats){\n                if (stats[i] !== 0){\n                    converted.push(stats[i]);\n                }\n            }\n            var testData = converted;\n            var maxRange = Math.max.apply(null, testData);\n            const I = d3.range(testData.length);\n            const X = d3.map(testData, d=>d);\n            const Y = d3.map(testData, d=>1);\n            const bins = d3.bin().thresholds(maxRange).value(i => X[i])(I);\n\n            const xDomain = [bins[0].x0, bins[bins.length - 1].x1];\n            const yDomain = [0, d3.max(bins, I => d3.sum(I, i => Y[i]))];\n            const xScale = d3.scaleLinear(xDomain, [margin.left, width - margin.right]);\n            const yScale = d3.scaleLinear(yDomain, [height - margin.bottom, margin.top]);\n            const xAxis = d3.axisBottom(xScale).ticks(width / 80).tickSizeOuter(0);\n            const yAxis = d3.axisLeft(yScale).ticks(height / 40);\n\n            var svg = d3.select('#pitch-range-svg')\n            svg.append(\"g\")\n                .attr('id', 'pitch-range-view-axis')\n                .attr(\"transform\", `translate(${margin.left},0)`)\n                .call(yAxis)\n                .call(g => g.select(\".domain\").remove())\n                .call(g => g.selectAll(\".tick line\").clone()\n                    .attr(\"x2\", width - margin.left - margin.right)\n                    .attr(\"stroke-opacity\", 0.1))\n                .call(g => g.append(\"text\")\n                    .attr(\"x\", margin.left)\n                    .attr(\"y\", 30)\n                    .attr(\"fill\", \"currentColor\")\n                    .attr(\"text-anchor\", \"start\"));\n\n            svg.append(\"g\")\n                .attr('id', 'pitch-range-view-rect')\n                .attr(\"fill\", themeColor[5])\n                .selectAll(\"rect\")\n                .data(bins)\n                .join(\"rect\")\n                .attr('class', 'pitch-range-view-single-rect')\n                .attr(\"data-aos\", 'zoom-in-up')\n                .attr(\"data-aos-delay\", d => d.x0*50)\n                .attr(\"x\", d => xScale(d.x0) + 0.5)\n                .attr(\"width\", d => Math.max(0, xScale(d.x1) - xScale(d.x0) - 0.5 - 0.5))\n                .attr(\"y\", d => yScale(d3.sum(d, i => Y[i])))\n                .attr(\"height\", d => yScale(0) - yScale(d3.sum(d, i => Y[i])))\n                .on(\"mouseover\",function(e,d){\n                    console.log(d)\n                    d3.select(this).attr(\"fill\", 'orange')\n                    d3.select('#pitch-range-tooltip').attr('opacity', '1').text(`[${d.x0},${d.x1}): ${d3.sum(d, i => Y[i])} Phrases`);\n                })\n                .on(\"mouseout\",function(e,d){\n                    d3.select(this).attr(\"fill\", themeColor[5])\n                    d3.select('#pitch-range-tooltip').attr('opacity', '0');\n                })\n                .append(\"title\")\n                .text((d, i) => [`${d.x0}  x < ${d.x1}`].join(\"\\n\"));\n\n            svg.append(\"g\")\n                .attr('id', 'pitch-range-view-label')\n                .attr(\"transform\", `translate(0,${height - margin.bottom})`)\n                .call(xAxis)\n                .call(g => g.append(\"text\")\n                    .attr(\"x\", width - margin.right)\n                    .attr(\"y\", 27)\n                    .attr(\"fill\", \"currentColor\")\n                    .attr(\"text-anchor\", \"end\"));\n\n            return {data:props.data, highlight:props.highlight}\n        }\n        if (props.highlight !== state.highlight){\n            var rects = d3.selectAll('.pitch-range-view-single-rect')\n            console.log(rects)\n            var song = props.data.filter((item) => item.id.toString() === props.highlight)\n            if  (song === undefined || song.length !== 1){\n                rects.attr('fill', d => themeColor[5])\n                return {data:props.data, highlight: props.highlight}\n            }\n            var allRanges = {}\n            for (let i in song[0].phrases){\n                allRanges[song[0].phrases[i].pitch_range] = song[0].phrases[i].pitch_range\n            }\n            rects.attr('fill', d => {\n                if (d.x0 in allRanges){\n                    return 'orange'\n                }\n                else{\n                    return themeColor[5]\n                }\n            })\n            return {data:props.data, highlight:props.highlight}\n        }\n        return {data:props.data, highlight:props.highlight}\n    }\n\n    render() {\n        return (\n            <div id='pitch-range-svg-parent-div'>\n                <svg id='pitch-range-svg' width='100%' height='100%' viewBox='0 0 535 197' preserveAspectRatio=\"none\">\n                <text id='pitch-range-tooltip' x='390' y='20' opacity='0'></text>\n                </svg>\n            </div>\n        )\n    }\n}\nfunction remove(idList){\n    for (let i in idList){\n        var ele=document.getElementById(idList[i]);\n        if (ele !== undefined && ele !== null){\n            ele.remove();\n        }\n    }\n}","import React, { Component } from 'react'\nimport * as d3 from 'd3'\n\nimport './index.css'\n\nconst width = 632;\nconst height = 464;\nvar nodeId = 0;\n\nexport default class ChordView extends Component {\n\n    state = {\n        data:this.props.data,\n        full:this.props.full\n    }\n\n    zoomed = ({transform}) => {\n        this.svg.attr(\"transform\", transform);\n    }\n\n    shouldComponentUpdate(nextProps, nextState){\n        if (nextProps.data !== this.state.data || nextProps.full !== this.state.full){\n            remove(['node-group', 'link-group']);\n            const zoom = d3.zoom().scaleExtent([0.1, 40]).on(\"zoom\", this.zoomed);\n            this.svg = d3.select('#chord-svg').append('g');\n            this.svg.call(zoom)\n            this.nodeGroup = this.svg.append('g').attr('id', 'node-group')\n            this.linkGroup = this.svg.append('g').attr('id', 'link-group')\n            var converted = processData(nextProps.data)\n            this.root = d3.hierarchy(converted);\n            this.node = undefined;\n            this.link = undefined;\n            this.sizeScale = d3.scaleSqrt().domain([0,converted.sum]).range([5,30]);\n            this.colorScale = d3.scalePow().exponent(0.2).domain([0,converted.sum]).range([0,0.7]);\n            this.update(true)\n        }\n        return true\n    }\n\n    static getDerivedStateFromProps(props, state){\n        return {data: props.data}\n    }\n\n    clicked =(e, d) => {\n        if (d.children) {\n            d._children = d.children;\n            d.children = null;\n            if (d.parent){\n                for(var i in d.parent._children){\n                    d.parent.children.push(d.parent._children[i]);\n                }\n                d.parent._children = null\n            }\n        }\n        else {\n            d.children = d._children;\n            d._children = null;\n            if (d.parent){\n                if (d.parent.children){\n                    d.parent._children = [];\n                    for (let i in d.parent.children){\n                        if (d.parent.children[i] !== d){\n                            d.parent._children.push(d.parent.children[i]);\n                        }\n                    }\n                    d.parent.children = [d];\n                }\n                console.log(d.parent.children, d.parent._children)\n            }\n            \n        }\n        this.update()\n    }\n\n    update = (withinit=false) => {\n        this.nodes = this.flatten(this.root);\n        const links = this.root.links();\n        if (withinit){\n            this.simulation = d3.forceSimulation()\n            .force('link', d3.forceLink(links).id(function(d) { return d.id; }).distance(100).strength(1))\n            .force('charge', d3.forceManyBody().strength(-50))\n            .force('center', d3.forceCenter( width/2, height/2 ))\n            .force(\"x\", d3.forceX())\n            .force(\"y\", d3.forceY())\n        }\n        const sizeScale = this.sizeScale;\n        const colorScale = this.colorScale;\n        this.link = this.linkGroup.selectAll('.link')\n                        .data(links, function(d){ return d.target.id })\n        \n        this.link.exit().remove()\n        const linkEnter = this.link.enter()\n                                    .append('line')\n                                    .attr('class', 'link')\n                                    .style('stroke', '#000' )\n                                    .style('opacity', '0.1')\n                                    .style('stroke-width', 1)\n        \n        this.link = linkEnter.merge(this.link)\n        \n        this.node = this.nodeGroup.selectAll('.node')\n                    .data(this.nodes, function(d){ return d.id })\n\n        this.node.exit().remove()\n        \n        const nodeEnter = this.node.enter()\n                                .append('g')\n                                .attr('class', 'node')\n                                .attr('stroke', '#666')\n                                .attr('stroke-width', 2)\n                                .style('fill', function(d) { \n                                    if(d.data.name === 'root'){\n                                        return 'red'\n                                    }\n                                    else{\n                                        return d3.interpolateBlues(colorScale(d.data.value))\n                                    }\n                                })\n                                .style('opacity', 1)\n                                .on('click', this.clicked)\n                                .call(drag(this.simulation))\n        \n        nodeEnter.append('circle')\n                    .attr(\"r\", function(d) { return sizeScale(d.data.value) })\n                    .on(\"mouseover\",function(e,d){\n                        d3.select(this).style('fill','orange')\n                        d3.select('#chord-tooltip').attr('opacity', '1').text(`${d.data.name}: ${d.data.value}`)\n                    })\n                    .on(\"mouseout\",function(e,d){\n                        d3.select(this).style('fill', function(d) { \n                            if(d.data.name === 'root'){\n                                return 'red'\n                            }\n                            else{\n                                return d3.interpolateBlues(colorScale(d.data.value)) \n                            }\n                        })\n                        d3.select('#chord-tooltip').attr('opacity', '0')\n                    })\n                    \n                    .text(function(d){ return d.data.name })\n        nodeEnter.append('text')\n                .style('text-anchor', 'middle')\n                .style('font-size', '12px')\n                .style('font-weight', '10px')\n                .attr('fill', 'black')\n                .style('user-select', 'none')\n                .attr('stroke-width', '0.5')\n                .text(function(d) { \n                    if (sizeScale(d.data.value) > 10){\n                        return d.data.name; \n                    }\n                    else{\n                        return '';\n                    }\n                });\n                    \n\n        this.node = nodeEnter.merge(this.node)\n        this.simulation.on('tick', () =>{\n            this.link\n            .attr('x1', function(d){ return d.source.x; })\n            .attr('y1', function(d){ return d.source.y; })\n            .attr('x2', function(d){ return d.target.x; })\n            .attr('y2', function(d){ return d.target.y; })\n        \n            this.node\n                .attr('transform', function(d){ return `translate(${d.x}, ${d.y})`})\n        })\n        this.simulation.nodes(this.nodes)\n        this.simulation.force('link').links(links)\n        if (withinit){\n            this.nodes.forEach(function(d) {\n                if (d.children && d.parent) {\n                    d._children = d.children;\n                    d.children = null;\n                }\n            });\n        }\n        if (withinit){\n            this.update()\n        }\n    }\n\n    flatten(root) {\n        var nodes = []\n        function recurse(node) {\n            if (node.children) node.children.forEach(recurse)\n            if (!node.id) node.id = ++nodeId;\n            else ++nodeId;\n            nodes.push(node)\n        }\n        recurse(root)\n        return nodes\n    }\n\n    componentDidMount(){\n    }\n\n    render() {\n        return (\n            <div id='chord-svg-parent-div'>\n                <svg id='chord-svg' width='100%' height='100%' viewBox='0 0 632 432' preserveAspectRatio=\"none\">\n                    <text id='chord-tooltip' x='550' y='30' opacity='0'></text>\n                </svg>\n            </div>\n        )\n    }\n}\n\nfunction drag(simulation){\n  \n  function dragstarted(event, d) {\n    if (!event.active) simulation.alphaTarget(0.3).restart();\n    d.fx = d.x;\n    d.fy = d.y;\n  }\n  \n  function dragged(event, d) {\n    d.fx = event.x;\n    d.fy = event.y;\n  }\n  \n  function dragended(event, d) {\n    if (!event.active) simulation.alphaTarget(0);\n    d.fx = null;\n    d.fy = null;\n  }\n  \n  return d3.drag()\n      .on(\"start\", dragstarted)\n      .on(\"drag\", dragged)\n      .on(\"end\", dragended);\n}\nfunction processData(data){\n    if (data){\n        var stats = {name:'root', value:0, children:[], sum:0}\n        for (let i in data){\n            for (let j in data[i].phrases){\n                var cp = [].concat(data[i].phrases[j].chord_progression);\n                var oriLength = cp.length;\n                var currentRoot = stats.children;\n                while (cp.length !== 0 && oriLength - cp.length <= 6){\n                    var current = cp.shift();\n                    var flag = false\n                    for (let k in currentRoot){\n                        if (currentRoot[k].name === current){\n                            flag = true;\n                            currentRoot[k].value += 1;\n                            currentRoot = currentRoot[k].children;\n                            break\n                        }\n                    }\n                    if (flag === false){\n                        currentRoot.push({name:current, value:1, children:[]})\n                        currentRoot = currentRoot[currentRoot.length-1].children\n                    }\n                }\n            }\n        }\n        stats.sum = d3.max(stats.children, d => d.value)\n        stats.value = 1\n        return stats\n    }\n}\nfunction remove(idList){\n    for (let i in idList){\n        var ele=document.getElementById(idList[i]);\n        if (ele !== undefined && ele !== null){\n            ele.remove();\n        }\n    }\n}","import React, { Component } from 'react'\nimport * as d3 from 'd3'\n\nimport './index.css'\n\n// var testData = {\n//     name:'I',\n//     value:'305',\n//     children:[\n//         {\n//             name:'V',\n//             value:'100',\n//             children:[{name:'ii',value:'100'}]\n//         },\n//         {\n//             name:'VII',\n//             value:'205',\n//         },\n//         {\n//             name:'IV',\n//             value:'205',\n//         },\n//         {\n//             name:'V',\n//             value:'205',\n//         }\n//     ]\n// }\n\nconst width = 1200;\nconst height = 800;\nvar nodeId = 0;\n\nexport default class ChordViewFull extends Component {\n\n    state = {\n        data:this.props.data,\n        full:this.props.full\n    }\n\n    shouldComponentUpdate(nextProps, nextState){\n        \n        return true\n    }\n\n    static getDerivedStateFromProps(props, state){\n        return {data: props.data}\n    }\n\n    clicked =(e, d) => {\n        if (d.children) {\n            d._children = d.children;\n            d.children = null;\n            if (d.parent){\n                for(var i in d.parent._children){\n                    d.parent.children.push(d.parent._children[i]);\n                }\n                d.parent._children = null\n            }\n        }\n        else {\n            d.children = d._children;\n            d._children = null;\n            if (d.parent){\n                if (d.parent.children){\n                    d.parent._children = [];\n                    for (let i in d.parent.children){\n                        if (d.parent.children[i] !== d){\n                            d.parent._children.push(d.parent.children[i]);\n                        }\n                    }\n                    d.parent.children = [d];\n                }\n                console.log(d.parent.children, d.parent._children)\n            }\n            \n        }\n        this.update()\n    }\n\n    update = (withinit=false) => {\n        this.nodes = this.flatten(this.root);\n        const links = this.root.links();\n        if (withinit){\n            this.simulation = d3.forceSimulation()\n            .force('link', d3.forceLink(links).id(function(d) { return d.id; }).distance(100).strength(1))\n            .force('charge', d3.forceManyBody().strength(-50))\n            .force('center', d3.forceCenter( width/2, height/2 ))\n            .force(\"x\", d3.forceX())\n            .force(\"y\", d3.forceY())\n        }\n        const sizeScale = this.sizeScale;\n        const colorScale = this.colorScale;\n        this.link = this.linkGroup.selectAll('.link')\n                        .data(links, function(d){ return d.target.id })\n        this.link.exit().remove()\n        const linkEnter = this.link.enter()\n                                    .append('line')\n                                    .attr('class', 'link')\n                                    .style('stroke', '#000' )\n                                    .style('opacity', '0.1')\n                                    .style('stroke-width', 1)\n        \n        this.link = linkEnter.merge(this.link)\n        \n        this.node = this.nodeGroup.selectAll('.node')\n                    .data(this.nodes, function(d){ return d.id })\n\n        this.node.exit().remove()\n        \n        const nodeEnter = this.node.enter()\n                                .append('g')\n                                .attr('class', 'node')\n                                .attr('stroke', '#666')\n                                .attr('stroke-width', 2)\n                                .style('fill', function(d) { \n                                    if(d.data.name === 'root'){\n                                        return 'red'\n                                    }\n                                    else{\n                                        return d3.interpolateBlues(colorScale(d.data.value))\n                                    }\n                                })\n                                .style('opacity', 1)\n                                .on('click', this.clicked)\n                                .call(drag(this.simulation))\n        \n        nodeEnter.append('circle')\n                    .attr(\"r\", function(d) { return sizeScale(d.data.value) })\n                    .on(\"mouseover\",function(e,d){\n                        d3.select(this).style('fill','orange')\n                        d3.select('#chord-full-tooltip').attr('opacity', '1').text(`${d.data.name}: ${d.data.value}`)\n                    })\n                    .on(\"mouseout\",function(e,d){\n                        d3.select(this).style('fill', function(d) { \n                            if(d.data.name === 'root'){\n                                return 'red'\n                            }\n                            else{\n                                return d3.interpolateBlues(colorScale(d.data.value))\n                            }\n                        })\n                        d3.select('#chord-full-tooltip').attr('opacity', '0')\n                    })\n                    \n                    .text(function(d){ return d.data.name })\n        nodeEnter.append('text')\n                .style('text-anchor', 'middle')\n                .style('font-size', '12px')\n                .style('font-weight', '10px')\n                .attr('fill', 'black')\n                .attr('stroke-width', '0.5')\n                .style('user-select', 'none')\n                .text(function(d) { \n                    if (sizeScale(d.data.value) > 10){\n                        return d.data.name; \n                    }\n                    else{\n                        return '';\n                    }\n                });\n                    \n\n        this.node = nodeEnter.merge(this.node)\n        this.simulation.on('tick', () =>{\n            this.link\n            .attr('x1', function(d){ return d.source.x; })\n            .attr('y1', function(d){ return d.source.y; })\n            .attr('x2', function(d){ return d.target.x; })\n            .attr('y2', function(d){ return d.target.y; })\n        \n            this.node\n                .attr('transform', function(d){ return `translate(${d.x}, ${d.y})`})\n        })\n        this.simulation.nodes(this.nodes)\n        this.simulation.force('link').links(links)\n        if (withinit){\n            this.nodes.forEach(function(d) {\n                if (d.children && d.parent) {\n                    d._children = d.children;\n                    d.children = null;\n                }\n            });\n        }\n        if (withinit){\n            this.update()\n        }\n    }\n\n    flatten(root) {\n        var nodes = []\n        function recurse(node) {\n            if (node.children) node.children.forEach(recurse)\n            if (!node.id) node.id = ++nodeId;\n            else ++nodeId;\n            nodes.push(node)\n        }\n        recurse(root)\n        return nodes\n    }\n\n    zoomed = ({transform}) => {\n        this.svg.attr(\"transform\", transform);\n    }\n\n    componentDidMount(){\n        remove(['node-group-full', 'link-group-full']);\n        const zoom = d3.zoom().scaleExtent([0.1, 40]).on(\"zoom\", this.zoomed);\n        this.svg = d3.select('#chord-full-svg').append('g');\n        this.svg.call(zoom)\n        this.nodeGroup = this.svg.append('g').attr('id', 'node-group-full')\n        this.linkGroup = this.svg.append('g').attr('id', 'link-group-full')\n        var converted = processData(this.props.data)\n        this.root = d3.hierarchy(converted);\n        this.node = undefined;\n        this.link = undefined;\n        this.sizeScale = d3.scaleSqrt().domain([0,converted.sum]).range([5,30]);\n        this.colorScale = d3.scalePow().exponent(0.2).domain([0,converted.sum]).range([0,0.7]);\n        this.update(true)\n    }\n\n    render() {\n        console.log(document.body.clientWidth, document.body.clientHeight)\n        return (\n            <div id='chord-full-svg-parent-div'>\n                <svg id='chord-full-svg' width='100%' height='100%' viewBox={`0 0 1200 800`} preserveAspectRatio=\"none\">\n                    <text id='chord-full-tooltip' x='600' y='30' opacity='0'></text>\n                    </svg>\n            </div>\n        )\n    }\n}\n\nfunction drag(simulation){\n  \n  function dragstarted(event, d) {\n    if (!event.active) simulation.alphaTarget(0.3).restart();\n    d.fx = d.x;\n    d.fy = d.y;\n  }\n  \n  function dragged(event, d) {\n    d.fx = event.x;\n    d.fy = event.y;\n  }\n  \n  function dragended(event, d) {\n    if (!event.active) simulation.alphaTarget(0);\n    d.fx = null;\n    d.fy = null;\n  }\n  \n  return d3.drag()\n      .on(\"start\", dragstarted)\n      .on(\"drag\", dragged)\n      .on(\"end\", dragended);\n}\nfunction processData(data){\n    if (data){\n        var stats = {name:'root', value:0, children:[], sum:0}\n        for (let i in data){\n            for (let j in data[i].phrases){\n                var cp = [].concat(data[i].phrases[j].chord_progression);\n                var oriLength = cp.length;\n                var currentRoot = stats.children;\n                while (cp.length !== 0 && oriLength - cp.length <= 6){\n                    var current = cp.shift();\n                    var flag = false\n                    for (let k in currentRoot){\n                        if (currentRoot[k].name === current){\n                            flag = true;\n                            currentRoot[k].value += 1;\n                            currentRoot = currentRoot[k].children;\n                            break\n                        }\n                    }\n                    if (flag === false){\n                        currentRoot.push({name:current, value:1, children:[]})\n                        currentRoot = currentRoot[currentRoot.length-1].children\n                    }\n                }\n            }\n        }\n        stats.value = 1\n        stats.sum = d3.max(stats.children, d => d.value)\n        return stats\n    }\n}\nfunction remove(idList){\n    for (let i in idList){\n        var ele=document.getElementById(idList[i]);\n        if (ele !== undefined && ele !== null){\n            ele.remove();\n        }\n    }\n}","import React, { Component } from 'react'\n\nexport default class Logo extends Component {\n    render() {\n        return (\n            <div style={{...this.props.style}}>\n                <svg width={`${265*this.props.scale}`} height={`${514*this.props.scale}`} xmlns=\"http://www.w3.org/2000/svg\" p-id=\"2612\" version=\"1.1\" className=\"icon\" t=\"1637598946996\">\n                    <g>\n                        <title>Layer 1</title>\n                        <g transform={`scale(${this.props.scale})`}>\n                            <g transform=\"rotate(-10.9933 133.009 261.703)\" stroke=\"null\" id=\"svg_4\">\n                                <ellipse stroke=\"null\" transform=\"matrix(0.978843 -0.20694 0.204614 0.989973 -60.9424 106.009)\" ry=\"80.62528\" rx=\"49.04126\" id=\"svg_2\" cy=\"58.41445\" cx=\"221.87915\" fill=\"#003a8c\"/>\n                                <path stroke=\"null\" id=\"svg_1\" fill=\"#003a8c\" p-id=\"2613\" d=\"m-25.21157,385.52743l143.54639,127.62276l0.2097,0.85981l31.0519,-7.7464l-72.95014,-299.11262c32.55553,21.2682 76.64091,31.11797 118.10777,20.77339c71.63232,-17.86985 107.54542,-88.81399 93.45645,-146.58208c-14.08607,-57.75617 -73.76928,-84.31403 -145.41057,-66.44195c-71.63232,17.86985 -127.48733,73.25059 -113.40126,131.00677l68.87714,284.39781l-102.48413,-91.10618l-21.00244,46.3285l-0.00081,0.0002zm177.46029,-331.88306c51.17781,-12.76714 97.69289,3.23174 105.51529,35.30538c7.8253,32.08555 -21.27342,87.49784 -72.45123,100.26497c-51.16845,12.7648 -102.41743,-22.60344 -110.24273,-54.689c-7.82252,-32.07416 26.01023,-68.11655 77.17867,-80.88135z\"/>\n                            </g>\n                        </g>\n                    </g>\n                </svg>\n            </div>\n        )\n    }\n}\n","import React from 'react';\nimport { Divider, Spin, Badge, Tooltip, notification, Button } from 'antd';\nimport { LoadingOutlined, QuestionCircleOutlined, BulbOutlined, FullscreenOutlined } from '@ant-design/icons';\nimport PubSub from 'pubsub-js';\nimport * as d3 from 'd3';\nimport AOS from 'aos';\nimport SongSelector from '../SongSelector'\nimport PhraseSelector from '../PhraseSelector';\nimport ModeSelector from '../ModeSelector';\nimport YearBrusher from '../YearBrusher';\nimport SongView from '../SongView';\nimport KeyModeView from '../KeyModeView';\nimport MelodyView from '../MelodyView';\nimport MeterView from '../MeterView';\nimport ChordDurationView from '../ChordDurationView';\nimport PitchRangeView from '../PitchRangeView';\nimport ChordView from '../ChordView';\nimport ChordViewFull from '../ChordViewFull';\nimport Logo from '../Logo';\nimport { themeColor, server, fullScreen, noteText } from '../utils';\nimport './index.css';\nimport 'aos/dist/aos.css';\n\nconst loading1 = <div style={{textAlign:'center', paddingTop:'20px'}}><Spin indicator={<LoadingOutlined style={{ fontSize: 30 }} spin />} tip='Loading...'/></div>\nconst loading2 = <div style={{textAlign:'center', paddingTop:'250px'}}><Spin indicator={<LoadingOutlined style={{ fontSize: 30 }} spin />} tip='Loading...'/></div>\nconst loading3 = <div style={{textAlign:'center', paddingTop:'100px'}}><Spin indicator={<LoadingOutlined style={{ fontSize: 30 }} spin />} tip='Loading...'/></div>\nconst closebtn = <Button type=\"primary\" size=\"small\" onClick={() => notification.close('help')}>Ok</Button>\nexport default class Main extends React.Component {\n\n    state = {\n        data:[],\n        dataFiltered:[],\n        yearFilter:null,\n        phraseFilter:[true,true,true,true,true],\n        modeFilter:[true,true],\n        highlight:'-1',\n        songSelect:'-1',\n        fullscreen:false,\n    }\n    parseDate = d3.timeParse('%Y-%m-%d');\n\n    componentDidMount(){\n        AOS.init({\n            offset: 0,\n            duration: 200,\n            easing: 'ease-in-quad',\n            delay: 0,\n          });\n        server('/data', this, 'data');\n        this.yearFilterChangeSub = PubSub.subscribe('yearFilterChange', this.onYearFilterChange);\n        this.phraseFilterChangeSub = PubSub.subscribe('phraseFilterChange', this.onPhraseFilterChange);\n        this.modeFilterChangeSub = PubSub.subscribe('modeFilterChange', this.onModeFilterChange);\n        this.songSelectChangeSub = PubSub.subscribe('songSelectChange', this.onSongSelectChange);\n        this.fullSub = PubSub.subscribe('full', this.exitfull);\n        this.showWelcome();\n    }\n    enterFullscreen = () => {\n        fullScreen();\n        this.setState({fullscreen:true})\n    }\n    exitfull = () => {\n        this.setState({fullscreen:false})\n    }\n    showWelcome(){\n        notification.open({\n            key:'welcome',\n            message: 'Welcome to POPVIS!',\n            description: noteText.welcome,\n            duration:10,\n            icon: <BulbOutlined style={{color:'green'}}/>\n          });\n    }\n    showHelp(title, des){\n        notification.open({\n            message: 'User Guide: ' + title,\n            description:des,\n            duration:0,\n            btn:closebtn,\n            key:'help',\n            onClose: () => {},\n            icon: <QuestionCircleOutlined style={{color:'#1890ff'}}/>\n        });\n    }\n    showSelectorHelp = () => {\n        this.showHelp('Selector Card', noteText.selector)\n    }\n    showStatisticsHelp = () => {\n        this.showHelp('Statistics Card', noteText.statistics)\n    }\n    showSongHelp = () => {\n        this.showHelp('Song Card', noteText.song)\n    }\n    showChordProgressionHelp = () => {\n        this.showHelp('Chord Progression View', noteText.chord)\n    }\n    showMelodyHelp = () => {\n        this.showHelp('Melody Pieces View', noteText.melody)\n    }\n    showKeyModeHelp = () => {\n        this.showHelp('Key-Mode View', noteText.keyMode)\n    }\n    showPitchRangeHelp = () => {\n        this.showHelp('Pitch Range View', noteText.pitchRange)\n    }\n    showChordDurationHelp = () => {\n        this.showHelp('Chord Duration View', noteText.chordDuration)\n    }\n    showMeterHelp = () => {\n        this.showHelp('Meter View', noteText.meter)\n    }\n\n    onYearFilterChange = (name, msg) => {\n        this.filterData(msg, this.state.phraseFilter, this.state.modeFilter, 'yearFilter', msg);\n    }\n    onPhraseFilterChange = (name, msg) => {\n        this.filterData(this.state.yearFilter, msg, this.state.modeFilter, 'phraseFilter', msg);\n    }\n    onModeFilterChange = (name, msg) => {\n        this.filterData(this.state.yearFilter, this.state.phraseFilter, msg, 'modeFilter', msg);\n    }\n    onHighlightChange = (h) => {\n        this.setState({highlight:h});\n    }\n    onSongSelectChange = (name, msg) => {\n        this.setState({songSelect:msg});\n    }\n\n    filterData = (year, phrase, mode, from, msg) => {\n        var filtered = []\n        for(var i = 0; i < this.state.data.length; i++) {\n            var flag = true;\n            var dataCopy = JSON.parse(JSON.stringify(this.state.data[i]));\n            var songDate = this.parseDate(dataCopy.publish_date);\n            if (songDate < year[0] ||  songDate > year[1]){\n                flag = false;\n            }\n            var newPhrases = [];\n            for (var j =0; j < dataCopy.phrases.length; j++){\n                if ((mode[0] === true && dataCopy.phrases[j].mode === 'maj')\n                    || (mode[1] === true && dataCopy.phrases[j].mode === 'min')){\n                        var label = dataCopy.phrases[j].label;\n                        if ((phrase[0] === true && (label === 'i' || label === 'I'))\n                        || (phrase[1] === true && (label === 'a' || label === 'A'))\n                        || (phrase[2] === true && (label === 'b' || label === 'B'))\n                        || (phrase[3] === true && (label === 'o' || label === 'O'))\n                        || (phrase[4] === true && (label !== 'i' && label !== 'I' \n                                                && label !== 'a' && label !== 'A' \n                                                && label !== 'b' && label !== 'B' \n                                                && label !== 'o' && label !== 'O'))){\n                            newPhrases.push(dataCopy.phrases[j]);\n                        }\n                }\n            }\n            dataCopy.phrases = newPhrases;\n            if (flag === true){\n                filtered.push(dataCopy)\n            }\n        }\n        this.setState({dataFiltered:filtered, [from]:msg});\n    }\n\n    componentWillUnmount(){\n        PubSub.unsubscribe(this.yearFilterChangeSub);\n        PubSub.unsubscribe(this.phraseFilterChangeSub);\n        PubSub.unsubscribe(this.modeFilterChangeSub);\n        PubSub.unsubscribe(this.songSelectChangeSub);\n    }\n\n    render(){\n        return (\n            <div style={!this.state.fullscreen? {marginLeft:'4%', marginRight:'4%'}:{margin:'0px'}}>\n            {!this.state.fullscreen? \n            <>\n                <div className='header'>\n                    <div style={{float:'left', minWidth:'2%',minHeight:'100%', backgroundColor:themeColor[10]}}></div>\n                    <div style={{float:'left', minWidth:'40%'}}>\n                        <div style={{float:'left', marginLeft:'5%'}}>\n                            <Logo scale={0.2} style={{float:'left',marginTop:'10px'}}/>\n                        </div>\n                        <div style={{float:'left', marginLeft:'5px'}}>\n                            <h1 className='main-title' style={{color:themeColor[8]}}>OPVIS</h1>\n                            <Divider style={{marginTop:'0px',marginBottom:'10px', lineHeight:'1px'}} />\n                            <h5 className='main-des'>A visualization of POP909 dataset</h5>\n                        </div>\n                    </div>\n                    <div style={{float:'right', marginLeft:'20px', minWidth:'50%',minHeight:'100%', backgroundColor:themeColor[10]}}></div>\n                </div>\n                <div data-aos-once={true} data-aos='flip-down' data-aos-delay={400}>\n                <Badge.Ribbon text={<div onClick={this.showSelectorHelp} className='card-title'><Tooltip title = 'Click to show help' color='green'>Selector</Tooltip></div>} color='green'>\n                    <div className='year-brusher card' >\n                    {this.state.data.length === 0 ? loading1:\n                        <div id='year-brusher-box'>\n                            <YearBrusher \n                                data={this.state.data}\n                            />\n                        </div>\n                    }\n                        <div className='main-display-selector'>\n                            <div className='phrase-selector'>\n                                <PhraseSelector/>\n                            </div>\n                            <Divider type='vertical' style={{float:'left', marginTop:'14px', backgroundColor:'gray', marginLeft:'1%'}}></Divider>\n                            <div className='mode-selector'>\n                                <ModeSelector/>\n                            </div>\n                        </div>\n                    </div>\n                    </Badge.Ribbon>\n                </div>\n                <div data-aos-once={true} data-aos='flip-right' data-aos-delay={600}>\n                <Badge.Ribbon text={<div onClick={this.showStatisticsHelp} className='card-title'><Tooltip title = 'Click to show help' color='blue'>Statistics</Tooltip></div>} >\n                    <div className='main-display card' >\n                    {this.state.data.length === 0 ? loading2:\n                        <>\n                            <div className='song-selector' style={{backgroundColor:themeColor[10]}}>\n                                <SongSelector data={this.state.dataFiltered} highlightChange={(h) => {this.onHighlightChange(h)}} yearFilter={this.state.yearFilter}/>\n                            </div>\n                            <div className='song-selector-right'>\n                                <div className='main-display-major'>\n                                    <div className='chord-view view' data-aos='flip-down' data-aos-delay={700} data-aos-once={true}>\n                                        <div className='view-title'><Tooltip title = 'Click to show help' color='blue' onClick={this.showChordProgressionHelp}>Chord Progressions: Click to explore</Tooltip> <Tooltip title='Click to enter fullscreen mode' color='blue'><FullscreenOutlined style={{marginLeft:'10px'}} onClick={this.enterFullscreen}/></Tooltip></div>\n                                        <ChordView data={this.state.dataFiltered} full={false}/>\n                                    </div>\n                                    <div className='melody-view view' data-aos='flip-right' data-aos-delay={800} data-aos-once={true}>\n                                        <div className='view-title' onClick={this.showMelodyHelp}><Tooltip title = 'Click to show help' color='blue'>Melody Pieces: Hover to highlight</Tooltip></div>\n                                        <MelodyView data={this.state.dataFiltered}/>\n                                    </div>\n                                </div>\n                                <div className='main-display-minor'>\n                                    <div className='key-mode-view view' data-aos='flip-up' data-aos-delay={100} data-aos-once={true}>\n                                        <div className='view-title' onClick={this.showKeyModeHelp}><Tooltip title = 'Click to show help' color='blue'>Keys and Modes</Tooltip></div>\n                                        <KeyModeView data={this.state.dataFiltered} highlight={this.state.highlight}/>\n                                    </div>\n                                    <div className='little-view-group'>\n                                        <div className='pitch-range-view view' data-aos='flip-up' data-aos-delay={200} data-aos-once={true}>\n                                            <div className='view-title' onClick={this.showPitchRangeHelp}><Tooltip title = 'Click to show help' color='blue'>Pitch range: Dynamics of Melody</Tooltip></div>\n                                            <PitchRangeView data={this.state.dataFiltered} highlight={this.state.highlight}/>\n                                        </div>\n                                        <div className='pie-view-group'>\n                                            <div className='chord-duration-view view' data-aos='flip-down' data-aos-delay={300} data-aos-once={true}>\n                                                <div className='view-title' onClick={this.showChordDurationHelp}><Tooltip title = 'Click to show help' color='blue'>Chord Duration: Pie Chart</Tooltip></div>\n                                                <ChordDurationView data={this.state.dataFiltered} highlight={this.state.highlight}/>\n                                            </div>\n                                            <div className='meter-view view' data-aos='flip-down' data-aos-once={true}>\n                                                <div className='view-title' onClick={this.showMeterHelp}><Tooltip title = 'Click to show help' color='blue'>Meters: Pie Chart</Tooltip></div>\n                                                <MeterView data={this.state.dataFiltered} highlight={this.state.highlight}/>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </>\n                    }\n                    </div>\n                    </Badge.Ribbon>\n                </div>\n                <div data-aos='flip-up' data-aos-once={true} data-aos-offset={300}>\n                    <Badge.Ribbon text={<div onClick={this.showSongHelp} className='card-title'><Tooltip title = 'Click to show help' color='gold'>Song Viewer</Tooltip></div>} color='gold'>\n                    <div className='song-display card'>\n                    {this.state.data.length === 0 ? loading3:<SongView data={this.state.data} song={this.state.songSelect}/>\n                    }\n                    </div>\n                    </Badge.Ribbon>\n                </div>\n                <div className='footer' >POP-909 Dataset: Wang, Ziyu, et al. \"Pop909: A pop-song dataset for music arrangement generation.\" arXiv preprint arXiv:2008.07142 (2020).</div>\n                <div className='footer' style={{paddingBottom:'30x',}}>POP909 Dataset Phrase Analysis: Dai, Shuqi, et al \"Automatic Analysis and Influence of Hierarchical Structure on Melody, Rhythm and Harmony in Popular Music.\" arXiv preprint arXiv:2010.07518 (2020).</div>\n                <div className='footer'><span style={{float:'left', paddingTop:'10px', paddingBottom:'100px'}}>NYU Shanghai  Information Visualization Final Project</span> <span style={{float:'right', paddingTop:'10px', paddingBottom:'100px'}}> Copyright @ Billy Yi | </span></div>\n            </>:\n            <>\n                <ChordViewFull data={this.state.dataFiltered} full={true}/> \n            </>\n                }\n            </div>\n        )\n    }\n    \n}\n\n","import React, { Component } from 'react';\n\nexport default class TestComp extends Component {\n\n    componentDidMount(){\n\n    \n    }\n\n    brushed = (selection) => {\n        console.log(selection)\n    }\n\n    render() {\n        return (<></>\n        )\n    }\n}\n","import Main from './Main';\nimport TestComp from './TestComp';\nimport './App.css';\nimport \"antd/dist/antd.css\";\n\nconst test = false;\nfunction App() {\n    return (\n        <div className=\"App\">\n            {test? <TestComp></TestComp>:<Main></Main>}\n        </div>\n    );\n}\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}